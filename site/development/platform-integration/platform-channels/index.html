
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Writing custom platform-specific code | Flutter</title>
    <link rel="icon" href="/assets/images/shared/brand/flutter/icon/64.png">
    <link rel="apple-touch-icon" href="/assets/images/shared/brand/flutter/logo/flutter-logomark-320px.png">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="#ffffff">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preload" href="https://use.fontawesome.com/releases/v5.15.1/js/all.js" as="script">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    

    <meta name="description" content="Learn how to write custom platform-specific code in your app.">
    <meta name="keywords" content="">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@flutterdev">

    <meta property="og:title" content="Writing custom platform-specific code">
    <meta property="og:url" content="http://0.0.0.0:4002/development/platform-integration/platform-channels">
    <meta property="og:description" content="Learn how to write custom platform-specific code in your app.">
    <meta property="og:image" content="http://0.0.0.0:4002/assets/images/flutter-logo-sharing.png">

    <link href="https://fonts.googleapis.com/css?family=Google+Sans:400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Material+Icons" rel="stylesheet">
    <script
      src="https://use.fontawesome.com/releases/v5.15.1/js/all.js"
      data-auto-replace-svg="nest">
    </script>
    <script>
      window.__CALLBACKS = [];
    </script>

    <link rel="stylesheet" href="/assets/css/main.css?v=1679552870">
    </head>
  <body>

    <section id="cookie-notice">
  <div class="container">
    <p>Google uses cookies to deliver its services, to personalize ads, and to 
      analyze traffic. You can adjust your privacy controls anytime in your 
      <a href="https://myaccount.google.com/data-and-personalization" target="_blank" rel="noopener">Google settings</a>. 
      <a href="https://policies.google.com/technologies/cookies" target="_blank" rel="noopener">Learn more</a>.
    </p>
    <button id="cookie-consent" class="btn btn-primary">Okay</button>
  </div>
</section>

  
    
    
    <div id="overlay-under-drawer"></div>

    

<header class="site-header">
  <nav class="navbar navbar-expand-md justify-content-start justify-content-md-between">
    <button 
      class="navbar-toggler" 
      type="button" 
      data-toggle="collapse" 
      data-target="#navbarSupportedContent" 
      aria-controls="navbarSupportedContent" 
      aria-expanded="false" 
      aria-label="Toggle navigation">
      <i class="material-icons">menu</i>
    </button>

    <a class="navbar-brand" href="http://0.0.0.0:4002">
      <img 
        src='/assets/images/shared/brand/flutter/logo/flutter-lockup.png' 
        alt='Flutter logo' 
        height="37" 
        width="129" 
        class="align-middle">
    </a>

    <div 
      id="navbarSupportedContent"
      class="collapse navbar-collapse flex-grow-0">
      <div 
        class="site-header__sheet-bg" 
        data-toggle="collapse" 
        data-target="#navbarSupportedContent" 
        aria-controls="navbarSupportedContent" 
        aria-expanded="false" 
        aria-label="Toggle navigation">
      </div>
      <div class="site-header__sheet">
        <ul class="navbar-nav">
          <div class="site-sidebar site-sidebar--header d-md-none">
            <ul class="nav flex-column"><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-1" role="button"
        aria-expanded="false" aria-controls="sidenav-1"
      >Get started</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1">
        <li class="nav-item">
    <a class="nav-link" href="/get-started/install">1. Install</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/editor">2. Set up an editor</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/test-drive">3. Test drive</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/codelab">4. Write your first app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/learn-more">5. Learn more</a>
  </li>

<div class="dropdown-divider"></div><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-1-7"
      href="#sidenav-1-7" role="button"
      aria-expanded="false" aria-controls="sidenav-1-7"
    >From another platform?
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/android-devs">Flutter for Android devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/swiftui-devs">Flutter for SwiftUI devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/uikit-devs">Flutter for UIKit devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/react-native-devs">Flutter for React Native devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/web-devs">Flutter for web devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/xamarin-forms-devs">Flutter for Xamarin.Forms devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/declarative">Introduction to declarative UI</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link" href="https://dart.dev/overview" target="_blank" rel="noopener">Dart language overview<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-2" role="button"
        aria-expanded="false" aria-controls="sidenav-2"
      >Samples & tutorials</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2">
        <li class="nav-item">
    <a class="nav-link" href="https://gallery.flutter.dev" target="_blank" rel="noopener">Flutter Gallery [running app]<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/gallery" target="_blank" rel="noopener">Flutter Gallery [repo]<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/samples/" target="_blank" rel="noopener">Sample apps on GitHub<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/cookbook">Cookbook</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/codelabs">Codelabs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/tutorials">Tutorials</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link active" data-toggle="collapse" href="#sidenav-3" role="button"
        aria-expanded="true" aria-controls="sidenav-3"
      >Development</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3">
        <li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1"
      href="/development/ui" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1"
    >User interface
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/widgets-intro">Introduction to widgets</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-2"
      href="/development/ui/layout" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-2"
    >Building layouts
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-2">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout">Layouts in Flutter</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/tutorial">Tutorial</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/adaptive-responsive">Creating adaptive and responsive apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/building-adaptive-apps">Building adaptive apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/constraints">Understanding constraints</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/box-constraints">Box constraints</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/ui/interactive">Adding interactivity</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/ui/assets-and-images">Assets and images</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/ui/material">Material Design</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-6"
      href="/development/ui/navigation" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-6"
    >Navigation & routing
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation">Navigation in Flutter</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation/deep-linking">Deep linking</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation/url-strategies">URL strategies</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-7"
      href="/development/ui/animations" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-7"
    >Animations
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations">Introduction</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/tutorial">Tutorial</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/implicit-animations">Implicit animations</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/hero-animations">Hero animations</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/staggered-animations">Staggered animations</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-8"
      href="/development/ui/advanced" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-8"
    >Advanced UI
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-8">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/actions_and_shortcuts">Actions & shortcuts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/typography">Fonts & typography</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/focus">Keyboard focus system</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/gestures">Gestures</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/shaders">Shaders</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/slivers">Slivers</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/ui/widgets">Widget catalog</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-2"
      href="/development/data-and-backend" role="button"
      aria-expanded="false" aria-controls="sidenav-3-2"
    >Data & backend
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-2">
      <li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-2-1"
      href="/development/data-and-backend/state-mgmt" role="button"
      aria-expanded="false" aria-controls="sidenav-3-2-1"
    >State management
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-2-1">
      <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/intro">Introduction</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/declarative">Think declaratively</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/ephemeral-vs-app">Ephemeral vs app state</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/simple">Simple app state management</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/options">Options</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/networking">Networking & http</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/json">JSON and serialization</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/firebase">Firebase</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-3"
      href="/development/accessibility-and-localization" role="button"
      aria-expanded="false" aria-controls="sidenav-3-3"
    >Accessibility & internationalization
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/accessibility-and-localization/accessibility">Accessibility</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/accessibility-and-localization/internationalization">Internationalization</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link active collapsable"
      data-toggle="collapse" data-target="#sidenav-3-4"
      href="/development/platform-integration" role="button"
      aria-expanded="true" aria-controls="sidenav-3-4"
    >Platform integration
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/release-notes/supported-platforms">Supported platforms</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/desktop">Building desktop apps with Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link active" href="/development/platform-integration/platform-channels">Writing platform-specific code</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-4"
      href="/development/platform-integration/android" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-4"
    >Android
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/splash-screen">Adding a splash screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/c-interop">C interop</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/platform-views">Hosting native Android views</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/androidx-migration">AndroidX migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/splash-screen-migration">Deprecated Splash Screen API Migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/chromeos">Targeting ChromeOS with Android</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-5"
      href="/development/platform-integration/ios" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-5"
    >iOS
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-5">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/apple-frameworks">Leveraging Apple's system libraries</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/splash-screen">Adding a splash screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/ios-app-clip">Adding iOS App Clip support</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/app-extensions">Adding iOS app extensions</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/c-interop">C interop</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/platform-views">Hosting native iOS views</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/ios-debugging">iOS debugging</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-6"
      href="/development/platform-integration/linux" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-6"
    >Linux
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/linux/building">Building Linux apps</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-7"
      href="/development/platform-integration/macos" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-7"
    >macOS
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/macos/building">Building macOS apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/macos/c-interop">C interop</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-8"
      href="/development/platform-integration/web" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-8"
    >Web
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-8">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/building">Building web apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/faq">Web FAQ</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/renderers">Web renderers</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/initialization">Custom app initialization</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/web-images">Displaying images on the web</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-9"
      href="/development/platform-integration/windows" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-9"
    >Windows
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-9">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/building">Building Windows apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/run-loop-migration">Run loop migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/version-migration">Version information migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/dark-mode-migration">Dark mode migration</a>
  </li>
  </ul>
  </li></ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-5"
      href="/development/packages-and-plugins" role="button"
      aria-expanded="false" aria-controls="sidenav-3-5"
    >Packages & plugins
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-5">
      <li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/background-processes">Background processes</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/developing-packages">Developing packages & plugins</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/favorites">Flutter Favorites program</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/happy-paths">Happy paths project</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/happy-paths/recommended">Happy paths recommendations</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/plugins-in-tests">Plugins in Flutter tests</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/using-packages">Using packages</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/flutter" target="_blank" rel="noopener">Package site<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6"
      href="/development/add-to-app" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6"
    >Add Flutter to an existing app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app">Introduction</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6-2"
      href="/development/add-to-app/android" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6-2"
    >Adding to an Android app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-2">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/project-setup">Project setup</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-screen">Add a single Flutter screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-fragment">Add a Flutter Fragment</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-view">Add a Flutter View</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/plugin-setup">Plugin setup</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6-3"
      href="/development/add-to-app/ios" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6-3"
    >Adding to an iOS app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/ios/project-setup">Project setup</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/ios/add-flutter-screen">Add a single Flutter screen</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/debugging">Debugging & hot reload</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/performance">Loading sequence and performance</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/multiple-flutters">Multiple Flutter instances</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7"
      href="/development/tools" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7"
    >Tools & features
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/android-studio">Android Studio & IntelliJ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/vs-code">Visual Studio Code</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7-3"
      href="/development/tools/devtools" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7-3"
    >DevTools
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/android-studio">Install from Android Studio & IntelliJ</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/vscode">Install from VS Code</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/cli">Install from command line</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/inspector">Flutter inspector</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/performance">Performance view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/cpu-profiler">CPU Profiler view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/memory">Memory view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/network">Network view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/debugger">Debugger</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/logging">Logging view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/app-size">App size tool</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/release-notes">Release notes</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7-4"
      href="/development/tools/sdk" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7-4"
    >Flutter SDK
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/upgrading">Upgrading</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/releases">Releases</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/release/breaking-changes">Breaking changes</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/release-notes">Release notes</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/tools/pubspec">Flutter and the pubspec file</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/hot-reload">Hot reload</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/flutter-fix">Flutter Fix</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/formatting">Code formatting</a>
  </li>

</ul>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-4" role="button"
        aria-expanded="false" aria-controls="sidenav-4"
      >Testing & debugging</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4">
        <li class="nav-item">
    <a class="nav-link" href="/testing/debugging">Debugging tools</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/testing-plugins">Testing plugins **NEW**</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/code-debugging">Debugging apps programmatically</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/oem-debuggers">Using an OEM debugger</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/build-modes">Flutter's build modes</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/common-errors">Common Flutter errors</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/errors">Handling errors</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing">Testing</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/integration-tests">Integration testing</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/integration-tests/migration">Migrating from flutter_driver</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-5" role="button"
        aria-expanded="false" aria-controls="sidenav-5"
      >Performance & optimization</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5">
        <li class="nav-item">
    <a class="nav-link" href="/perf">Overview</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/best-practices">Performance best practices</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/app-size">App size</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/deferred-components">Deferred components</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/rendering-performance">Rendering performance</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/ui-performance">Performance profiling</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/shader">Shader compilation jank</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/metrics">Performance metrics</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/faq">Performance FAQ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/appendix">Appendix</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-6" role="button"
        aria-expanded="false" aria-controls="sidenav-6"
      >Deployment</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6">
        <li class="nav-item">
    <a class="nav-link" href="/deployment/obfuscate">Obfuscating Dart code</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/flavors">Creating flavors for Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/android">Build and release an Android app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/ios">Build and release an iOS app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/macos">Build and release a macOS app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/linux">Build and release a Linux app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/windows">Build and release a Windows app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/web">Build and release a web app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/cd">Continuous deployment</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-7" role="button"
        aria-expanded="false" aria-controls="sidenav-7"
      >Resources</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-7">
        <li class="nav-item">
    <a class="nav-link" href="/resources/architectural-overview">Architectural overview</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/books">Books</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/compatibility">Compatibility policy</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/flutter/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener">Contributing to Flutter<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/bug-reports">Creating useful bug reports</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/bootstrap-into-dart">Dart resources</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/design-docs">Design documents</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/faq">FAQ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/games-toolkit">Casual Games Toolkit</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/packages/google_fonts" target="_blank" rel="noopener">Google Fonts package<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/inside-flutter">Inside Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/dart-swift-concurrency">Flutter vs. Swift Concurrency</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://flutter.dev/brand" target="_blank" rel="noopener">Official brand assets<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/platform-adaptations">Platform adaptations</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/videos">Videos and online courses</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link " data-toggle="collapse" href="#sidenav-8" role="button"
        aria-expanded="true" aria-controls="sidenav-8"
      >Reference</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-8">
        <li class="nav-item">
    <a class="nav-link" href="/dash">Who is Dash?</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/widgets">Widget index</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://api.flutter.dev" target="_blank" rel="noopener">API reference<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/flutter-cli">flutter CLI reference</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/security-false-positives">Security false positives</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/flutter" target="_blank" rel="noopener">Package site<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>


</ul>
    </li></ul>

          </div>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="platform-navbar-dropdown"
               href="https://flutter.dev/multi-platform" 
               role="button" data-toggle="dropdown" 
               aria-haspopup="true" aria-expanded="false">
               Multi-Platform
            </a>
            <div class="dropdown-menu" aria-labelledby="platform-navbar-dropdown">
              <a class="dropdown-item" href="https://flutter.dev/multi-platform/mobile">Mobile</a>
              <a class="dropdown-item" href="https://flutter.dev/multi-platform/web">Web</a>
              <a class="dropdown-item" href="https://flutter.dev/multi-platform/desktop">Desktop</a>
              <a class="dropdown-item" href="https://flutter.dev/multi-platform/embedded">Embedded</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="dev-navbar-dropdown"
               href="https://flutter.dev/development"
               role="button" data-toggle="dropdown" 
               aria-haspopup="true" aria-expanded="false">
               Development
            </a>
            <div class="dropdown-menu" aria-labelledby="dev-navbar-dropdown">
              <a class="dropdown-item" href="https://flutter.dev/learn">Learn</a>
              <a class="dropdown-item" href="https://pub.dev/flutter/favorites" target="_blank">Flutter Favorites</a>
              <a class="dropdown-item" href="https://pub.dev/" target="_blank">Packages</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" id="ecosystem-navbar-dropdown"
               href="https://flutter.dev/ecosystem"
               role="button" data-toggle="dropdown" 
               aria-haspopup="true" aria-expanded="false">
               Ecosystem
            </a>
            <div class="dropdown-menu" aria-labelledby="ecosystem-navbar-dropdown">
              <a class="dropdown-item" href="https://flutter.dev/community">Community</a>
              <a class="dropdown-item" href="https://flutter.dev/events">Events</a>
              <a class="dropdown-item" href="https://flutter.dev/monetization">Monetization</a>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="https://flutter.dev/showcase">Showcase</a>
          </li>
          <li class="nav-item dropdown docs-item">
            <a class="nav-link dropdown-toggle"
               id="docs-navbar-dropdown"
               href="/"
               role="button" data-toggle="dropdown" 
               aria-haspopup="true" aria-expanded="false">
               Docs
            </a>
            <div class="dropdown-menu" aria-labelledby="docs-navbar-dropdown">
              <a class="dropdown-item "
                 href="/whats-new">What's new</a>
              <a class="dropdown-item "
                 href="/get-started/editor">Editor support</a>
              <a class="dropdown-item "
                 href="/development/tools/hot-reload">Hot reload</a>
              <a class="dropdown-item "
                 href="/perf/ui-performance">Profiling</a>
              <a class="dropdown-item "
                 href="/get-started/install">Install Flutter</a>
              <a class="dropdown-item "
                 href="/development/tools/devtools/overview">DevTools</a>
              <a class="dropdown-item "
                 href="/cookbook">Cookbook</a>
              <a class="dropdown-item "
                 href="/reference/tutorials">Tutorials</a>
            </div>
          </li>
        </ul>
        <form action="/search/" class="site-header__search form-inline">
          <input 
            class="site-header__searchfield form-control" 
            type="search" name="q" id="q" autocomplete="off" 
            placeholder="Search" aria-label="Search">
        </form>
      </div>
    </div>
    <div class="site-header__social navbar-nav flex-row">
      <a 
        class="nav-item nav-link" 
        href="https://twitter.com/FlutterDev" 
        aria-label="Twitter">
        <i class="fab fa-twitter fa-lg"></i>
      </a>
      <a 
        class="nav-item nav-link" 
        href="https://www.youtube.com/@flutterdev" 
        aria-label="YouTube">
        <i class="fab fa-youtube fa-lg"></i>
    </a>
      <a 
        class="nav-item nav-link" 
        href="https://github.com/flutter" 
        aria-label="GitHub">
        <i class="fab fa-github fa-lg"></i>
    </a>
    </div>
    <a 
        class="site-header__cta btn btn-primary" 
        href="/get-started/install/">Get started
      </a>
    </nav>
</header>


    <div class="site-banner site-banner--default" role="alert">
  We want your thoughts on implementing deep links in Flutter.<br>
  By taking part in this study, you'll directly impact Flutter’s
  deep linking support.<br>
  <a href= https://goo.gle/3KVF8bq">Sign up for a chance to be included.</a>
  </div>



    <div class="container-fluid position-relative">
  <div class="row flex-xl-nowrap">
    <div class="fixed-col site-sidebar site-sidebar--fixed col-12 col-md-3 col-xl-2 d-none d-md-block" data-fixed-column>
      
      <ul class="nav flex-column"><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-1" role="button"
        aria-expanded="false" aria-controls="sidenav-1"
      >Get started</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1">
        <li class="nav-item">
    <a class="nav-link" href="/get-started/install">1. Install</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/editor">2. Set up an editor</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/test-drive">3. Test drive</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/codelab">4. Write your first app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/learn-more">5. Learn more</a>
  </li>

<div class="dropdown-divider"></div><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-1-7"
      href="#sidenav-1-7" role="button"
      aria-expanded="false" aria-controls="sidenav-1-7"
    >From another platform?
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/android-devs">Flutter for Android devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/swiftui-devs">Flutter for SwiftUI devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/uikit-devs">Flutter for UIKit devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/react-native-devs">Flutter for React Native devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/web-devs">Flutter for web devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/xamarin-forms-devs">Flutter for Xamarin.Forms devs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/get-started/flutter-for/declarative">Introduction to declarative UI</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link" href="https://dart.dev/overview" target="_blank" rel="noopener">Dart language overview<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-2" role="button"
        aria-expanded="false" aria-controls="sidenav-2"
      >Samples & tutorials</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-2">
        <li class="nav-item">
    <a class="nav-link" href="https://gallery.flutter.dev" target="_blank" rel="noopener">Flutter Gallery [running app]<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/gallery" target="_blank" rel="noopener">Flutter Gallery [repo]<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://flutter.github.io/samples/" target="_blank" rel="noopener">Sample apps on GitHub<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/cookbook">Cookbook</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/codelabs">Codelabs</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/tutorials">Tutorials</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link active" data-toggle="collapse" href="#sidenav-3" role="button"
        aria-expanded="true" aria-controls="sidenav-3"
      >Development</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3">
        <li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1"
      href="/development/ui" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1"
    >User interface
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/widgets-intro">Introduction to widgets</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-2"
      href="/development/ui/layout" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-2"
    >Building layouts
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-2">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout">Layouts in Flutter</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/tutorial">Tutorial</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/adaptive-responsive">Creating adaptive and responsive apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/building-adaptive-apps">Building adaptive apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/constraints">Understanding constraints</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/layout/box-constraints">Box constraints</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/ui/interactive">Adding interactivity</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/ui/assets-and-images">Assets and images</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/ui/material">Material Design</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-6"
      href="/development/ui/navigation" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-6"
    >Navigation & routing
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation">Navigation in Flutter</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation/deep-linking">Deep linking</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/navigation/url-strategies">URL strategies</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-7"
      href="/development/ui/animations" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-7"
    >Animations
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations">Introduction</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/tutorial">Tutorial</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/implicit-animations">Implicit animations</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/hero-animations">Hero animations</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/animations/staggered-animations">Staggered animations</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-1-8"
      href="/development/ui/advanced" role="button"
      aria-expanded="false" aria-controls="sidenav-3-1-8"
    >Advanced UI
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-1-8">
      <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/actions_and_shortcuts">Actions & shortcuts</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/typography">Fonts & typography</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/focus">Keyboard focus system</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/gestures">Gestures</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/shaders">Shaders</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/ui/advanced/slivers">Slivers</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/ui/widgets">Widget catalog</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-2"
      href="/development/data-and-backend" role="button"
      aria-expanded="false" aria-controls="sidenav-3-2"
    >Data & backend
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-2">
      <li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-2-1"
      href="/development/data-and-backend/state-mgmt" role="button"
      aria-expanded="false" aria-controls="sidenav-3-2-1"
    >State management
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-2-1">
      <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/intro">Introduction</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/declarative">Think declaratively</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/ephemeral-vs-app">Ephemeral vs app state</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/simple">Simple app state management</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/state-mgmt/options">Options</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/networking">Networking & http</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/json">JSON and serialization</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/data-and-backend/firebase">Firebase</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-3"
      href="/development/accessibility-and-localization" role="button"
      aria-expanded="false" aria-controls="sidenav-3-3"
    >Accessibility & internationalization
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/accessibility-and-localization/accessibility">Accessibility</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/accessibility-and-localization/internationalization">Internationalization</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link active collapsable"
      data-toggle="collapse" data-target="#sidenav-3-4"
      href="/development/platform-integration" role="button"
      aria-expanded="true" aria-controls="sidenav-3-4"
    >Platform integration
    </a>
    <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-3-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/release-notes/supported-platforms">Supported platforms</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/desktop">Building desktop apps with Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link active" href="/development/platform-integration/platform-channels">Writing platform-specific code</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-4"
      href="/development/platform-integration/android" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-4"
    >Android
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/splash-screen">Adding a splash screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/c-interop">C interop</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/platform-views">Hosting native Android views</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/androidx-migration">AndroidX migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/splash-screen-migration">Deprecated Splash Screen API Migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/android/chromeos">Targeting ChromeOS with Android</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-5"
      href="/development/platform-integration/ios" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-5"
    >iOS
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-5">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/apple-frameworks">Leveraging Apple's system libraries</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/splash-screen">Adding a splash screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/ios-app-clip">Adding iOS App Clip support</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/app-extensions">Adding iOS app extensions</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/c-interop">C interop</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/platform-views">Hosting native iOS views</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/ios/ios-debugging">iOS debugging</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-6"
      href="/development/platform-integration/linux" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-6"
    >Linux
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/linux/building">Building Linux apps</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-7"
      href="/development/platform-integration/macos" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-7"
    >macOS
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/macos/building">Building macOS apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/macos/c-interop">C interop</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-8"
      href="/development/platform-integration/web" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-8"
    >Web
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-8">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/building">Building web apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/faq">Web FAQ</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/renderers">Web renderers</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/initialization">Custom app initialization</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/web/web-images">Displaying images on the web</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-4-9"
      href="/development/platform-integration/windows" role="button"
      aria-expanded="false" aria-controls="sidenav-3-4-9"
    >Windows
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-4-9">
      <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/building">Building Windows apps</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/run-loop-migration">Run loop migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/version-migration">Version information migration</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/platform-integration/windows/dark-mode-migration">Dark mode migration</a>
  </li>
  </ul>
  </li></ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-5"
      href="/development/packages-and-plugins" role="button"
      aria-expanded="false" aria-controls="sidenav-3-5"
    >Packages & plugins
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-5">
      <li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/background-processes">Background processes</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/developing-packages">Developing packages & plugins</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/favorites">Flutter Favorites program</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/happy-paths">Happy paths project</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/happy-paths/recommended">Happy paths recommendations</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/plugins-in-tests">Plugins in Flutter tests</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/packages-and-plugins/using-packages">Using packages</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/flutter" target="_blank" rel="noopener">Package site<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6"
      href="/development/add-to-app" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6"
    >Add Flutter to an existing app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app">Introduction</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6-2"
      href="/development/add-to-app/android" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6-2"
    >Adding to an Android app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-2">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/project-setup">Project setup</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-screen">Add a single Flutter screen</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-fragment">Add a Flutter Fragment</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/add-flutter-view">Add a Flutter View</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/android/plugin-setup">Plugin setup</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-6-3"
      href="/development/add-to-app/ios" role="button"
      aria-expanded="false" aria-controls="sidenav-3-6-3"
    >Adding to an iOS app
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-6-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/ios/project-setup">Project setup</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/ios/add-flutter-screen">Add a single Flutter screen</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/debugging">Debugging & hot reload</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/performance">Loading sequence and performance</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/add-to-app/multiple-flutters">Multiple Flutter instances</a>
  </li>

</ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7"
      href="/development/tools" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7"
    >Tools & features
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/android-studio">Android Studio & IntelliJ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/vs-code">Visual Studio Code</a>
  </li>

<li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7-3"
      href="/development/tools/devtools" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7-3"
    >DevTools
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7-3">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/android-studio">Install from Android Studio & IntelliJ</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/vscode">Install from VS Code</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/cli">Install from command line</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/inspector">Flutter inspector</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/performance">Performance view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/cpu-profiler">CPU Profiler view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/memory">Memory view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/network">Network view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/debugger">Debugger</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/logging">Logging view</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/app-size">App size tool</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/devtools/release-notes">Release notes</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link collapsable collapsed"
      data-toggle="collapse" data-target="#sidenav-3-7-4"
      href="/development/tools/sdk" role="button"
      aria-expanded="false" aria-controls="sidenav-3-7-4"
    >Flutter SDK
    </a>
    <ul class="nav flex-column flex-nowrap collapse " id="sidenav-3-7-4">
      <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/overview">Overview</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/upgrading">Upgrading</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/releases">Releases</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/release/breaking-changes">Breaking changes</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="/development/tools/sdk/release-notes">Release notes</a>
  </li>
  </ul>
  </li><li class="nav-item">
    <a class="nav-link" href="/development/tools/pubspec">Flutter and the pubspec file</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/hot-reload">Hot reload</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/flutter-fix">Flutter Fix</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/development/tools/formatting">Code formatting</a>
  </li>

</ul>
  </li>
</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-4" role="button"
        aria-expanded="false" aria-controls="sidenav-4"
      >Testing & debugging</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-4">
        <li class="nav-item">
    <a class="nav-link" href="/testing/debugging">Debugging tools</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/testing-plugins">Testing plugins **NEW**</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/code-debugging">Debugging apps programmatically</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/oem-debuggers">Using an OEM debugger</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/build-modes">Flutter's build modes</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/common-errors">Common Flutter errors</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/errors">Handling errors</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing">Testing</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/integration-tests">Integration testing</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/testing/integration-tests/migration">Migrating from flutter_driver</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-5" role="button"
        aria-expanded="false" aria-controls="sidenav-5"
      >Performance & optimization</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-5">
        <li class="nav-item">
    <a class="nav-link" href="/perf">Overview</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/best-practices">Performance best practices</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/app-size">App size</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/deferred-components">Deferred components</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/rendering-performance">Rendering performance</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/ui-performance">Performance profiling</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/shader">Shader compilation jank</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/metrics">Performance metrics</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/faq">Performance FAQ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/perf/appendix">Appendix</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-6" role="button"
        aria-expanded="false" aria-controls="sidenav-6"
      >Deployment</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-6">
        <li class="nav-item">
    <a class="nav-link" href="/deployment/obfuscate">Obfuscating Dart code</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/flavors">Creating flavors for Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/android">Build and release an Android app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/ios">Build and release an iOS app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/macos">Build and release a macOS app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/linux">Build and release a Linux app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/windows">Build and release a Windows app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/web">Build and release a web app</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/deployment/cd">Continuous deployment</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link collapsed" data-toggle="collapse" href="#sidenav-7" role="button"
        aria-expanded="false" aria-controls="sidenav-7"
      >Resources</a>

      <ul class="nav flex-column flex-nowrap collapse " id="sidenav-7">
        <li class="nav-item">
    <a class="nav-link" href="/resources/architectural-overview">Architectural overview</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/books">Books</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/compatibility">Compatibility policy</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://github.com/flutter/flutter/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener">Contributing to Flutter<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/bug-reports">Creating useful bug reports</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/bootstrap-into-dart">Dart resources</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/design-docs">Design documents</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/faq">FAQ</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/games-toolkit">Casual Games Toolkit</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/packages/google_fonts" target="_blank" rel="noopener">Google Fonts package<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/inside-flutter">Inside Flutter</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/dart-swift-concurrency">Flutter vs. Swift Concurrency</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://flutter.dev/brand" target="_blank" rel="noopener">Official brand assets<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/platform-adaptations">Platform adaptations</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/resources/videos">Videos and online courses</a>
  </li>


</ul>
    </li><li class="nav-item">
      <a class="nav-link " data-toggle="collapse" href="#sidenav-8" role="button"
        aria-expanded="true" aria-controls="sidenav-8"
      >Reference</a>

      <ul class="nav flex-column flex-nowrap collapse show" id="sidenav-8">
        <li class="nav-item">
    <a class="nav-link" href="/dash">Who is Dash?</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/widgets">Widget index</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://api.flutter.dev" target="_blank" rel="noopener">API reference<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/flutter-cli">flutter CLI reference</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="/reference/security-false-positives">Security false positives</a>
  </li>

<li class="nav-item">
    <a class="nav-link" href="https://pub.dev/flutter" target="_blank" rel="noopener">Package site<span class="material-icons md-24">
        open_in_new
      </span></a>
  </li>


</ul>
    </li></ul>

    </div>

    
  
  
  
  <div
    id="site-toc--side"
    class="site-toc site-toc--side fixed-col col-xl-2 order-3 "
    data-fixed-column
  >
    <header class="site-toc__title">
      Contents
      </header>
    <ul id="toc" class="section-nav">
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#architecture">Architectural overview: platform channels</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#codec">Platform channel data types support and codecs</a></li>
</ul>
</li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#example">Example: Calling platform-specific code using platform channels</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#example-project">Step 1: Create a new app project</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#example-client">Step 2: Create the Flutter platform client</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#step-3-add-an-android-platform-specific-implementation">Step 3: Add an Android platform-specific implementation</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#step-4-add-an-ios-platform-specific-implementation">Step 4: Add an iOS platform-specific implementation</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#step-5-add-a-windows-platform-specific-implementation">Step 5: Add a Windows platform-specific implementation</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#step-6-add-a-linux-platform-specific-implementation">Step 6: Add a Linux platform-specific implementation</a></li>
</ul>
</li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#pigeon">Typesafe platform channels using Pigeon</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#pigeon-example">Pigeon example</a></li>
</ul>
</li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#separate">Separate platform-specific code from UI code</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#publish">Publish platform-specific code as a package</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#custom-channels-and-codecs">Custom channels and codecs</a></li>
<li class="toc-entry nav-item toc-h2"><a class="nav-link" href="#channels-and-platform-threading">Channels and platform threading</a>
<ul class="nav">
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#using-plugins-and-channels-from-background-isolates">Using plugins and channels from background isolates</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#executing-channel-handlers-on-background-threads">Executing channel handlers on background threads</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#jumping-to-the-ui-thread-in-android">Jumping to the UI thread in Android</a></li>
<li class="toc-entry nav-item toc-h3"><a class="nav-link" href="#jumping-to-the-main-thread-in-ios">Jumping to the main thread in iOS</a></li>
</ul>
</li>
</ul>
  </div>
<main class="site-content col-12 col-md-9 offset-md-3 col-xl-8 offset-xl-2 col-xxl-8 offset-xxl-2">
      <div class="container">

        

        

        <header class="site-content__title">
          <div id="page-github-links" class="btn-group" aria-label="Page GitHub links" role="group">
  <a href="https://github.com/flutter/website/tree/main/src/development/platform-integration/platform-channels.md" class="btn no-automatic-external" title="View page source" target="_blank" rel="noopener">
    <i class="fas fa-file-alt fa-sm"></i>
  </a>
  <a href="https://github.com/flutter/website/issues/new?template=1_page_issue.yml&title=[PAGE ISSUE]: 'Writing custom platform-specific code'&page-url=http://0.0.0.0:4002/development/platform-integration/platform-channels/&page-source=https://github.com/flutter/website/tree/main/src/development/platform-integration/platform-channels.md" class="btn no-automatic-external" title="Report an issue with this page"
    target="_blank" rel="noopener">
    <i class="fas fa-bug fa-sm"></i>
  </a>
</div>

          <h1>Writing custom platform-specific code</h1>
          

<nav aria-label="breadcrumb">
  <ol class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList">
  <li class="breadcrumb-item"
      property="itemListElement" typeof="ListItem"><a href="/development/platform-integration" property="item" typeof="WebPage"><span property="name">Platform integration</span>
      </a>
      <meta property="position" content="1" />
    </li>
  <li class="breadcrumb-item active"
      property="itemListElement" typeof="ListItem" aria-current="page"><a href="/development/platform-integration/platform-channels" property="item" typeof="WebPage"><span property="name">Platform-specific code</span>
      </a>
      <meta property="position" content="2" />
    </li>
  
  </ol>
</nav>
          </header>
        
        <div
    id="site-toc--inline"
    class="site-toc site-toc--inline "
  >
    <header class="site-toc__title">
      Contents
    </header>
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#architecture">Architectural overview: platform channels</a>
<ul>
<li class="toc-entry toc-h3"><a href="#codec">Platform channel data types support and codecs</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#example">Example: Calling platform-specific code using platform channels</a>
<ul>
<li class="toc-entry toc-h3"><a href="#example-project">Step 1: Create a new app project</a></li>
<li class="toc-entry toc-h3"><a href="#example-client">Step 2: Create the Flutter platform client</a></li>
<li class="toc-entry toc-h3"><a href="#step-3-add-an-android-platform-specific-implementation">Step 3: Add an Android platform-specific implementation</a></li>
<li class="toc-entry toc-h3"><a href="#step-4-add-an-ios-platform-specific-implementation">Step 4: Add an iOS platform-specific implementation</a></li>
<li class="toc-entry toc-h3"><a href="#step-5-add-a-windows-platform-specific-implementation">Step 5: Add a Windows platform-specific implementation</a></li>
<li class="toc-entry toc-h3"><a href="#step-6-add-a-linux-platform-specific-implementation">Step 6: Add a Linux platform-specific implementation</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#pigeon">Typesafe platform channels using Pigeon</a>
<ul>
<li class="toc-entry toc-h3"><a href="#pigeon-example">Pigeon example</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#separate">Separate platform-specific code from UI code</a></li>
<li class="toc-entry toc-h2"><a href="#publish">Publish platform-specific code as a package</a></li>
<li class="toc-entry toc-h2"><a href="#custom-channels-and-codecs">Custom channels and codecs</a></li>
<li class="toc-entry toc-h2"><a href="#channels-and-platform-threading">Channels and platform threading</a>
<ul>
<li class="toc-entry toc-h3"><a href="#using-plugins-and-channels-from-background-isolates">Using plugins and channels from background isolates</a></li>
<li class="toc-entry toc-h3"><a href="#executing-channel-handlers-on-background-threads">Executing channel handlers on background threads</a></li>
<li class="toc-entry toc-h3"><a href="#jumping-to-the-ui-thread-in-android">Jumping to the UI thread in Android</a></li>
<li class="toc-entry toc-h3"><a href="#jumping-to-the-main-thread-in-ios">Jumping to the main thread in iOS</a></li>
</ul>
</li>
</ul>
  </div>

<p>This guide describes how to write custom platform-specific code.
Some platform-specific functionality is available
through existing packages;
see <a href="http://0.0.0.0:4002/development/packages-and-plugins/using-packages">using packages</a>.</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  The information in this page is valid for most platforms,
  but platform-specific code for the web generally uses
  <a href="https://dart.dev/web/js-interop">JS interoperability</a> or the <a href="https://api.dart.dev/dart-html/dart-html-library.html"><code class="language-plaintext highlighter-rouge">dart:html</code> library</a> instead.</p>
</aside>

<p>Flutter uses a flexible system that allows you to call
platform-specific APIs in a language that works directly
with those APIs:</p>

<ul>
  <li>Kotlin or Java on Android</li>
  <li>Swift or Objective-C on iOS</li>
  <li>C++ on Windows</li>
  <li>Objective-C on macOS</li>
  <li>C on Linux</li>
</ul>

<p>Flutter’s builtin platform-specific API support
doesn’t rely on code generation,
but rather on a flexible message passing style.
Alternatively, you can use the <a href="https://pub.dev/packages/pigeon">Pigeon</a>
package for <a href="#pigeon">sending structured typesafe messages</a>
with code generation:</p>

<ul>
  <li>
    <p>The Flutter portion of the app sends messages to its <em>host</em>,
the non-Dart portion of the app, over a platform channel.</p>
  </li>
  <li>
    <p>The <em>host</em> listens on the platform channel, and receives the message.
It then calls into any number of platform-specific APIs—using
the native programming language—and sends a response back to the
<em>client</em>, the Flutter portion of the app.</p>
  </li>
</ul>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  This guide addresses using the platform channel mechanism
  if you need to use the platform’s APIs in a non-Dart language.
  But you can also write platform-specific Dart code
  in your Flutter app by inspecting the
  <a href="https://api.flutter.dev/flutter/foundation/defaultTargetPlatform.html"><code class="language-plaintext highlighter-rouge">defaultTargetPlatform</code></a> property.
  <a href="http://0.0.0.0:4002/resources/platform-adaptations">Platform adaptations</a> lists some
  platform-specific adaptations that Flutter
  automatically performs for you in the framework.</p>
</aside>

<h2 id="architecture">
<a class="anchor" href="#architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Architectural overview: platform channels</h2>

<p>Messages are passed between the client (UI)
and host (platform) using platform
channels as illustrated in this diagram:</p>

<p><img src="http://0.0.0.0:4002/assets/images/docs/PlatformChannels.png" alt="Platform channels architecture" width="100%"></p>

<p>Messages and responses are passed asynchronously,
to ensure the user interface remains responsive.</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  Even though Flutter sends messages to and from Dart asynchronously,
  whenever you invoke a channel method, you must invoke that method on the
  platform’s main thread. See the <a href="#channels-and-platform-threading">section on threading</a>
  for more information.</p>
</aside>

<p>On the client side, <a href="https://api.flutter.dev/flutter/services/MethodChannel-class.html"><code class="language-plaintext highlighter-rouge">MethodChannel</code></a> enables sending
messages that correspond to method calls. On the platform side,
<code class="language-plaintext highlighter-rouge">MethodChannel</code> on Android (<a href="https://api.flutter.dev/javadoc/io/flutter/plugin/common/MethodChannel.html"><code class="language-plaintext highlighter-rouge">MethodChannelAndroid</code></a>) and
<code class="language-plaintext highlighter-rouge">FlutterMethodChannel</code> on iOS (<a href="https://api.flutter.dev/objcdoc/Classes/FlutterMethodChannel.html"><code class="language-plaintext highlighter-rouge">MethodChanneliOS</code></a>)
enable receiving method calls and sending back a
result. These classes allow you to develop a platform plugin
with very little ‘boilerplate’ code.</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  If desired, method calls can also be sent in the reverse direction,
  with the platform acting as client to methods implemented in Dart.
  For a concrete example, check out the <a href="https://pub.dev/packages/quick_actions"><code class="language-plaintext highlighter-rouge">quick_actions</code></a> plugin.</p>
</aside>

<h3 id="codec">
<a class="anchor" href="#codec" aria-hidden="true"><span class="octicon octicon-link"></span></a>Platform channel data types support and codecs</h3>

<p>The standard platform channels use a standard message codec that supports
efficient binary serialization of simple JSON-like values, such as booleans,
numbers, Strings, byte buffers, and Lists and Maps of these
(see <a href="https://api.flutter.dev/flutter/services/StandardMessageCodec-class.html"><code class="language-plaintext highlighter-rouge">StandardMessageCodec</code></a> for details).
The serialization and deserialization of these values to and from
messages happens automatically when you send and receive values.</p>

<p>The following table shows how Dart values are received on the
platform side and vice versa:</p>

<ul class="nav nav-tabs sample-code-tabs" id="type-mappings-language" role="tablist">
<li class="nav-item">
  <a class="nav-link active" id="type-mappings-java" href="#type-mappings-java-tab" role="tab" aria-controls="type-mappings-java" aria-selected="true">Java</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="type-mappings-kotlin" href="#type-mappings-kotlin-tab" role="tab" aria-controls="type-mappings-kotlin" aria-selected="true">Kotlin</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="type-mappings-obj-c" href="#type-mappings-obj-c-tab" role="tab" aria-controls="type-mappings-obj-c" aria-selected="true">Obj-C</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="type-mappings-swift" href="#type-mappings-swift-tab" role="tab" aria-controls="type-mappings-swift" aria-selected="true">Swift</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="type-mappings-c-plus-plus" href="#type-mappings-c-plus-plus-tab" role="tab" aria-controls="type-mappings-c-plus-plus" aria-selected="true">C++</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="type-mappings-c" href="#type-mappings-c-tab" role="tab" aria-controls="type-mappings-c" aria-selected="true">C</a>
</li>
</ul>
<div class="tab-content">

<div class="tab-pane active" id="type-mappings-java-tab" role="tabpanel" aria-labelledby="type-mappings-java-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>Java</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>null</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>java.lang.Boolean</td>
        </tr>
        <tr>
          <td>int</td>
          <td>java.lang.Integer</td>
        </tr>
        <tr>
          <td>int, if 32 bits not enough</td>
          <td>java.lang.Long</td>
        </tr>
        <tr>
          <td>double</td>
          <td>java.lang.Double</td>
        </tr>
        <tr>
          <td>String</td>
          <td>java.lang.String</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>byte[]</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>int[]</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>long[]</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>float[]</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>double[]</td>
        </tr>
        <tr>
          <td>List</td>
          <td>java.util.ArrayList</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>java.util.HashMap</td>
        </tr>
      </tbody>
    </table>

  </div>


<div class="tab-pane " id="type-mappings-kotlin-tab" role="tabpanel" aria-labelledby="type-mappings-kotlin-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>Kotlin</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>null</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>Boolean</td>
        </tr>
        <tr>
          <td>int</td>
          <td>Int</td>
        </tr>
        <tr>
          <td>int, if 32 bits not enough</td>
          <td>Long</td>
        </tr>
        <tr>
          <td>double</td>
          <td>Double</td>
        </tr>
        <tr>
          <td>String</td>
          <td>String</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>ByteArray</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>IntArray</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>LongArray</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>FloatArray</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>DoubleArray</td>
        </tr>
        <tr>
          <td>List</td>
          <td>List</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>HashMap</td>
        </tr>
      </tbody>
    </table>

  </div>


<div class="tab-pane " id="type-mappings-obj-c-tab" role="tabpanel" aria-labelledby="type-mappings-obj-c-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>Objective-C</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>nil (NSNull when nested)</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>NSNumber numberWithBool:</td>
        </tr>
        <tr>
          <td>int</td>
          <td>NSNumber numberWithInt:</td>
        </tr>
        <tr>
          <td>int, if 32 bits not enough</td>
          <td>NSNumber numberWithLong:</td>
        </tr>
        <tr>
          <td>double</td>
          <td>NSNumber numberWithDouble:</td>
        </tr>
        <tr>
          <td>String</td>
          <td>NSString</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>FlutterStandardTypedData typedDataWithBytes:</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>FlutterStandardTypedData typedDataWithInt32:</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>FlutterStandardTypedData typedDataWithInt64:</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>FlutterStandardTypedData typedDataWithFloat32:</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>FlutterStandardTypedData typedDataWithFloat64:</td>
        </tr>
        <tr>
          <td>List</td>
          <td>NSArray</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>NSDictionary</td>
        </tr>
      </tbody>
    </table>

  </div>


<div class="tab-pane " id="type-mappings-swift-tab" role="tabpanel" aria-labelledby="type-mappings-swift-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>Swift</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>nil</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>NSNumber(value: Bool)</td>
        </tr>
        <tr>
          <td>int</td>
          <td>NSNumber(value: Int32)</td>
        </tr>
        <tr>
          <td>int, if 32 bits not enough</td>
          <td>NSNumber(value: Int)</td>
        </tr>
        <tr>
          <td>double</td>
          <td>NSNumber(value: Double)</td>
        </tr>
        <tr>
          <td>String</td>
          <td>String</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>FlutterStandardTypedData(bytes: Data)</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>FlutterStandardTypedData(int32: Data)</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>FlutterStandardTypedData(int64: Data)</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>FlutterStandardTypedData(float32: Data)</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>FlutterStandardTypedData(float64: Data)</td>
        </tr>
        <tr>
          <td>List</td>
          <td>Array</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>Dictionary</td>
        </tr>
      </tbody>
    </table>

  </div>


<div class="tab-pane " id="type-mappings-c-plus-plus-tab" role="tabpanel" aria-labelledby="type-mappings-c-plus-plus-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>C++</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>EncodableValue()</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>EncodableValue(bool)</td>
        </tr>
        <tr>
          <td>int</td>
          <td>EncodableValue(int32_t)</td>
        </tr>
        <tr>
          <td>int, if 32 bits not enough</td>
          <td>EncodableValue(int64_t)</td>
        </tr>
        <tr>
          <td>double</td>
          <td>EncodableValue(double)</td>
        </tr>
        <tr>
          <td>String</td>
          <td>EncodableValue(std::string)</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>EncodableValue(std::vector<uint8_t>)</uint8_t>
</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>EncodableValue(std::vector<int32_t>)</int32_t>
</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>EncodableValue(std::vector<int64_t>)</int64_t>
</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>EncodableValue(std::vector<float>)</float>
</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>EncodableValue(std::vector<double>)</double>
</td>
        </tr>
        <tr>
          <td>List</td>
          <td>EncodableValue(std::vector<encodablevalue>)</encodablevalue>
</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>EncodableValue(std::map&lt;EncodableValue, EncodableValue&gt;)</td>
        </tr>
      </tbody>
    </table>

  </div>


<div class="tab-pane " id="type-mappings-c-tab" role="tabpanel" aria-labelledby="type-mappings-c-tab">

    <table>
      <thead>
        <tr>
          <th>Dart</th>
          <th>C (GObject)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>null</td>
          <td>FlValue()</td>
        </tr>
        <tr>
          <td>bool</td>
          <td>FlValue(bool)</td>
        </tr>
        <tr>
          <td>int</td>
          <td>FlValue(int64_t)</td>
        </tr>
        <tr>
          <td>double</td>
          <td>FlValue(double)</td>
        </tr>
        <tr>
          <td>String</td>
          <td>FlValue(gchar*)</td>
        </tr>
        <tr>
          <td>Uint8List</td>
          <td>FlValue(uint8_t*)</td>
        </tr>
        <tr>
          <td>Int32List</td>
          <td>FlValue(int32_t*)</td>
        </tr>
        <tr>
          <td>Int64List</td>
          <td>FlValue(int64_t*)</td>
        </tr>
        <tr>
          <td>Float32List</td>
          <td>FlValue(float*)</td>
        </tr>
        <tr>
          <td>Float64List</td>
          <td>FlValue(double*)</td>
        </tr>
        <tr>
          <td>List</td>
          <td>FlValue(FlValue)</td>
        </tr>
        <tr>
          <td>Map</td>
          <td>FlValue(FlValue, FlValue)</td>
        </tr>
      </tbody>
    </table>

  </div>

</div>

<h2 id="example">
<a class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example: Calling platform-specific code using platform channels</h2>

<p>The following code demonstrates how to call
a platform-specific API to retrieve and display
the current battery level.  It uses
the Android <code class="language-plaintext highlighter-rouge">BatteryManager</code> API,
the iOS <code class="language-plaintext highlighter-rouge">device.batteryLevel</code> API,
the Windows <code class="language-plaintext highlighter-rouge">GetSystemPowerStatus</code> API,
and the Linux <code class="language-plaintext highlighter-rouge">UPower</code> API with a single
platform message, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>.</p>

<p>The example adds the platform-specific code inside
the main app itself.  If you want to reuse the
platform-specific code for multiple apps,
the project creation step is slightly different
(see <a href="http://0.0.0.0:4002/development/packages-and-plugins/developing-packages#plugin">developing packages</a>),
but the platform channel code
is still written in the same way.</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  The full, runnable source-code for this example is
  available in <a href="https://github.com/flutter/flutter/tree/main/examples/platform_channel"><code class="language-plaintext highlighter-rouge">/examples/platform_channel/</code></a>
  for Android with Java, iOS with Objective-C,
  Windows with C++, and Linux with C.
  For iOS with Swift,
  see <a href="https://github.com/flutter/flutter/tree/main/examples/platform_channel_swift"><code class="language-plaintext highlighter-rouge">/examples/platform_channel_swift/</code></a>.</p>
</aside>

<h3 id="example-project">
<a class="anchor" href="#example-project" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 1: Create a new app project</h3>

<p>Start by creating a new app:</p>

<ul>
  <li>In a terminal run: <code class="language-plaintext highlighter-rouge">flutter create batterylevel</code>
</li>
</ul>

<p>By default, our template supports writing Android code using Kotlin,
or iOS code using Swift. To use Java or Objective-C,
use the <code class="language-plaintext highlighter-rouge">-i</code> and/or <code class="language-plaintext highlighter-rouge">-a</code> flags:</p>

<ul>
  <li>In a terminal run: <code class="language-plaintext highlighter-rouge">flutter create -i objc -a java batterylevel</code>
</li>
</ul>

<h3 id="example-client">
<a class="anchor" href="#example-client" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 2: Create the Flutter platform client</h3>

<p>The app’s <code class="language-plaintext highlighter-rouge">State</code> class holds the current app state.
Extend that to hold the current battery state.</p>

<p>First, construct the channel. Use a <code class="language-plaintext highlighter-rouge">MethodChannel</code> with a single
platform method that returns the battery level.</p>

<p>The client and host sides of a channel are connected through
a channel name passed in the channel constructor.
All channel names used in a single app must
be unique; prefix the channel name with a unique ‘domain
prefix’, for example: <code class="language-plaintext highlighter-rouge">samples.flutter.dev/battery</code>.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">import 'dart:async';
import 'package:flutter/material.dart';
import 'package:flutter/services.dart';</code></pre></div>
</div>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">class _MyHomePageState extends State&lt;MyHomePage&gt; {
  static const platform = MethodChannel('samples.flutter.dev/battery');
  // Get battery level.</code></pre></div>
</div>

<p>Next, invoke a method on the method channel,
specifying the concrete method to call using
the <code class="language-plaintext highlighter-rouge">String</code> identifier <code class="language-plaintext highlighter-rouge">getBatteryLevel</code>.
The call might fail—for example,
if the platform doesn’t support the
platform API (such as when running in a simulator),
so wrap the <code class="language-plaintext highlighter-rouge">invokeMethod</code> call in a try-catch statement.</p>

<p>Use the returned result to update the user interface state in <code class="language-plaintext highlighter-rouge">_batteryLevel</code>
inside <code class="language-plaintext highlighter-rouge">setState</code>.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">// Get battery level.
String _batteryLevel = 'Unknown battery level.';

Future&lt;void&gt; _getBatteryLevel() async {
  String batteryLevel;
  try {
    final int result = await platform.invokeMethod('getBatteryLevel');
    batteryLevel = 'Battery level at $result % .';
  } on PlatformException catch (e) {
    batteryLevel = "Failed to get battery level: '${e.message}'.";
  }

  setState(() {
    _batteryLevel = batteryLevel;
  });
}</code></pre></div>
</div>

<p>Finally, replace the <code class="language-plaintext highlighter-rouge">build</code> method from the template to
contain a small user interface that displays the battery
state in a string, and a button for refreshing the value.</p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">@override
Widget build(BuildContext context) {
  return Material(
    child: Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.spaceEvenly,
        children: [
          ElevatedButton(
            onPressed: _getBatteryLevel,
            child: const Text('Get Battery Level'),
          ),
          Text(_batteryLevel),
        ],
      ),
    ),
  );
}</code></pre></div>
</div>

<h3 id="step-3-add-an-android-platform-specific-implementation">
<a class="anchor" href="#step-3-add-an-android-platform-specific-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 3: Add an Android platform-specific implementation</h3>

<ul class="nav nav-tabs sample-code-tabs" id="android-channel-language" role="tablist">
<li class="nav-item">
  <a class="nav-link active" id="android-channel-kotlin" href="#android-channel-kotlin-tab" role="tab" aria-controls="android-channel-kotlin" aria-selected="true">Kotlin</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="android-channel-java" href="#android-channel-java-tab" role="tab" aria-controls="android-channel-java" aria-selected="true">Java</a>
</li>
</ul>
<div class="tab-content">

<div class="tab-pane active" id="android-channel-kotlin-tab" role="tabpanel" aria-labelledby="android-channel-kotlin-tab">

    <p>Start by opening the Android host portion of your Flutter app
in Android Studio:</p>

    <ol>
      <li>
        <p>Start Android Studio</p>
      </li>
      <li>
        <p>Select the menu item <strong>File &gt; Open…</strong></p>
      </li>
      <li>
        <p>Navigate to the directory holding your Flutter app,
and select the <strong>android</strong> folder inside it. Click <strong>OK</strong>.</p>
      </li>
      <li>
        <p>Open the file <code class="language-plaintext highlighter-rouge">MainActivity.kt</code> located in the <strong>kotlin</strong> folder in the
Project view.</p>
      </li>
    </ol>

    <p>Inside the <code class="language-plaintext highlighter-rouge">configureFlutterEngine()</code> method, create a <code class="language-plaintext highlighter-rouge">MethodChannel</code> and call
<code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code>. Make sure to use the same channel name as
was used on the Flutter client side.</p>

    <!--code-excerpt "MyActivity.kt" title-->
    <div class="language-kotlin highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">androidx.annotation.NonNull</span>
<span class="k">import</span> <span class="nn">io.flutter.embedding.android.FlutterActivity</span>
<span class="k">import</span> <span class="nn">io.flutter.embedding.engine.FlutterEngine</span>
<span class="k">import</span> <span class="nn">io.flutter.plugin.common.MethodChannel</span>

<span class="kd">class</span> <span class="nc">MainActivity</span><span class="p">:</span> <span class="nc">FlutterActivity</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">private</span> <span class="kd">val</span> <span class="py">CHANNEL</span> <span class="p">=</span> <span class="s">"samples.flutter.dev/battery"</span>

  <span class="k">override</span> <span class="k">fun</span> <span class="nf">configureFlutterEngine</span><span class="p">(</span><span class="nd">@NonNull</span> <span class="n">flutterEngine</span><span class="p">:</span> <span class="nc">FlutterEngine</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">super</span><span class="p">.</span><span class="nf">configureFlutterEngine</span><span class="p">(</span><span class="n">flutterEngine</span><span class="p">)</span>
    <span class="nc">MethodChannel</span><span class="p">(</span><span class="n">flutterEngine</span><span class="p">.</span><span class="n">dartExecutor</span><span class="p">.</span><span class="n">binaryMessenger</span><span class="p">,</span> <span class="nc">CHANNEL</span><span class="p">).</span><span class="nf">setMethodCallHandler</span> <span class="p">{</span>
      <span class="n">call</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
      <span class="c1">// This method is invoked on the main thread.</span>
      <span class="c1">// TODO</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Add the Android Kotlin code that uses the Android battery APIs to
retrieve the battery level. This code is exactly the same as you
would write in a native Android app.</p>

    <p>First, add the needed imports at the top of the file:</p>

    <!--code-excerpt "MyActivity.kt" title-->
    <div class="language-kotlin highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">android.content.Context</span>
<span class="k">import</span> <span class="nn">android.content.ContextWrapper</span>
<span class="k">import</span> <span class="nn">android.content.Intent</span>
<span class="k">import</span> <span class="nn">android.content.IntentFilter</span>
<span class="k">import</span> <span class="nn">android.os.BatteryManager</span>
<span class="k">import</span> <span class="nn">android.os.Build.VERSION</span>
<span class="k">import</span> <span class="nn">android.os.Build.VERSION_CODES</span>
</code></pre></div>    </div>

    <p>Next, add the following method in the <code class="language-plaintext highlighter-rouge">MainActivity</code> class,
below the <code class="language-plaintext highlighter-rouge">configureFlutterEngine()</code> method:</p>

    <!--code-excerpt "MyActivity.kt" title-->
    <div class="language-kotlin highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">private</span> <span class="k">fun</span> <span class="nf">getBatteryLevel</span><span class="p">():</span> <span class="nc">Int</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">batteryLevel</span><span class="p">:</span> <span class="nc">Int</span>
    <span class="k">if</span> <span class="p">(</span><span class="nc">VERSION</span><span class="p">.</span><span class="nc">SDK_INT</span> <span class="p">&gt;=</span> <span class="nc">VERSION_CODES</span><span class="p">.</span><span class="nc">LOLLIPOP</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">val</span> <span class="py">batteryManager</span> <span class="p">=</span> <span class="nf">getSystemService</span><span class="p">(</span><span class="nc">Context</span><span class="p">.</span><span class="nc">BATTERY_SERVICE</span><span class="p">)</span> <span class="k">as</span> <span class="nc">BatteryManager</span>
      <span class="n">batteryLevel</span> <span class="p">=</span> <span class="n">batteryManager</span><span class="p">.</span><span class="nf">getIntProperty</span><span class="p">(</span><span class="nc">BatteryManager</span><span class="p">.</span><span class="nc">BATTERY_PROPERTY_CAPACITY</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="kd">val</span> <span class="py">intent</span> <span class="p">=</span> <span class="nc">ContextWrapper</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">).</span><span class="nf">registerReceiver</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="nc">IntentFilter</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">ACTION_BATTERY_CHANGED</span><span class="p">))</span>
      <span class="n">batteryLevel</span> <span class="p">=</span> <span class="n">intent</span><span class="o">!!</span><span class="p">.</span><span class="nf">getIntExtra</span><span class="p">(</span><span class="nc">BatteryManager</span><span class="p">.</span><span class="nc">EXTRA_LEVEL</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">*</span> <span class="mi">100</span> <span class="p">/</span> <span class="n">intent</span><span class="p">.</span><span class="nf">getIntExtra</span><span class="p">(</span><span class="nc">BatteryManager</span><span class="p">.</span><span class="nc">EXTRA_SCALE</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">batteryLevel</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <p>Finally, complete the <code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code> method added earlier.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">call</code> argument.
The implementation of this platform method calls the
Android code written in the previous step, and returns a response for both
the success and error cases using the <code class="language-plaintext highlighter-rouge">result</code> argument.
If an unknown method is called, report that instead.</p>

    <p>Remove the following code:</p>

    <!--code-excerpt "MyActivity.kt" title-->
    <div class="language-kotlin highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>    <span class="nc">MethodChannel</span><span class="p">(</span><span class="n">flutterEngine</span><span class="p">.</span><span class="n">dartExecutor</span><span class="p">.</span><span class="n">binaryMessenger</span><span class="p">,</span> <span class="nc">CHANNEL</span><span class="p">).</span><span class="nf">setMethodCallHandler</span> <span class="p">{</span>
      <span class="n">call</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
      <span class="c1">// This method is invoked on the main thread.</span>
      <span class="c1">// TODO</span>
    <span class="p">}</span>
</code></pre></div>    </div>

    <p>And replace with the following:</p>

    <!--code-excerpt "MyActivity.kt" title-->
    <div class="language-kotlin highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>    <span class="nc">MethodChannel</span><span class="p">(</span><span class="n">flutterEngine</span><span class="p">.</span><span class="n">dartExecutor</span><span class="p">.</span><span class="n">binaryMessenger</span><span class="p">,</span> <span class="nc">CHANNEL</span><span class="p">).</span><span class="nf">setMethodCallHandler</span> <span class="p">{</span>
      <span class="c1">// This method is invoked on the main thread.</span>
      <span class="n">call</span><span class="p">,</span> <span class="n">result</span> <span class="p">-&gt;</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">call</span><span class="p">.</span><span class="n">method</span> <span class="p">==</span> <span class="s">"getBatteryLevel"</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">batteryLevel</span> <span class="p">=</span> <span class="nf">getBatteryLevel</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">batteryLevel</span> <span class="p">!=</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">result</span><span class="p">.</span><span class="nf">success</span><span class="p">(</span><span class="n">batteryLevel</span><span class="p">)</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="n">result</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s">"UNAVAILABLE"</span><span class="p">,</span> <span class="s">"Battery level not available."</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">}</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="nf">notImplemented</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>    </div>

  </div>


<div class="tab-pane " id="android-channel-java-tab" role="tabpanel" aria-labelledby="android-channel-java-tab">

    <p>Start by opening the Android host portion of your Flutter app
in Android Studio:</p>

    <ol>
      <li>
        <p>Start Android Studio</p>
      </li>
      <li>
        <p>Select the menu item <strong>File &gt; Open…</strong></p>
      </li>
      <li>
        <p>Navigate to the directory holding your Flutter app,
and select the <strong>android</strong> folder inside it. Click <strong>OK</strong>.</p>
      </li>
      <li>
        <p>Open the <code class="language-plaintext highlighter-rouge">MainActivity.java</code> file located in the <strong>java</strong> folder in the
Project view.</p>
      </li>
    </ol>

    <p>Next, create a <code class="language-plaintext highlighter-rouge">MethodChannel</code> and set a <code class="language-plaintext highlighter-rouge">MethodCallHandler</code>
inside the <code class="language-plaintext highlighter-rouge">configureFlutterEngine()</code> method.
Make sure to use the same channel name as was used on the
Flutter client side.</p>

    <!--code-excerpt "MainActivity.java" title-->
    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">androidx.annotation.NonNull</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.flutter.embedding.android.FlutterActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.flutter.embedding.engine.FlutterEngine</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.flutter.plugin.common.MethodChannel</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">FlutterActivity</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">CHANNEL</span> <span class="o">=</span> <span class="s">"samples.flutter.dev/battery"</span><span class="o">;</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">configureFlutterEngine</span><span class="o">(</span><span class="nd">@NonNull</span> <span class="nc">FlutterEngine</span> <span class="n">flutterEngine</span><span class="o">)</span> <span class="o">{</span>
  <span class="kd">super</span><span class="o">.</span><span class="na">configureFlutterEngine</span><span class="o">(</span><span class="n">flutterEngine</span><span class="o">);</span>
    <span class="k">new</span> <span class="nf">MethodChannel</span><span class="o">(</span><span class="n">flutterEngine</span><span class="o">.</span><span class="na">getDartExecutor</span><span class="o">().</span><span class="na">getBinaryMessenger</span><span class="o">(),</span> <span class="no">CHANNEL</span><span class="o">)</span>
        <span class="o">.</span><span class="na">setMethodCallHandler</span><span class="o">(</span>
          <span class="o">(</span><span class="n">call</span><span class="o">,</span> <span class="n">result</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// This method is invoked on the main thread.</span>
            <span class="c1">// TODO</span>
          <span class="o">}</span>
        <span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>

    <p>Add the Android Java code that uses the Android battery APIs to
retrieve the battery level. This code is exactly the same as you
would write in a native Android app.</p>

    <p>First, add the needed imports at the top of the file:</p>

    <!--code-excerpt "MainActivity.java" title-->
    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">android.content.ContextWrapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.IntentFilter</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.BatteryManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Build.VERSION</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Build.VERSION_CODES</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
</code></pre></div>    </div>

    <p>Then add the following as a new method in the activity class,
below the <code class="language-plaintext highlighter-rouge">configureFlutterEngine()</code> method:</p>

    <!--code-excerpt "MainActivity.java" title-->
    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="kd">private</span> <span class="kt">int</span> <span class="nf">getBatteryLevel</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">batteryLevel</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="no">VERSION</span><span class="o">.</span><span class="na">SDK_INT</span> <span class="o">&gt;=</span> <span class="no">VERSION_CODES</span><span class="o">.</span><span class="na">LOLLIPOP</span><span class="o">)</span> <span class="o">{</span>
      <span class="nc">BatteryManager</span> <span class="n">batteryManager</span> <span class="o">=</span> <span class="o">(</span><span class="nc">BatteryManager</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="no">BATTERY_SERVICE</span><span class="o">);</span>
      <span class="n">batteryLevel</span> <span class="o">=</span> <span class="n">batteryManager</span><span class="o">.</span><span class="na">getIntProperty</span><span class="o">(</span><span class="nc">BatteryManager</span><span class="o">.</span><span class="na">BATTERY_PROPERTY_CAPACITY</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ContextWrapper</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">()).</span>
          <span class="n">registerReceiver</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IntentFilter</span><span class="o">(</span><span class="nc">Intent</span><span class="o">.</span><span class="na">ACTION_BATTERY_CHANGED</span><span class="o">));</span>
      <span class="n">batteryLevel</span> <span class="o">=</span> <span class="o">(</span><span class="n">intent</span><span class="o">.</span><span class="na">getIntExtra</span><span class="o">(</span><span class="nc">BatteryManager</span><span class="o">.</span><span class="na">EXTRA_LEVEL</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">*</span> <span class="mi">100</span><span class="o">)</span> <span class="o">/</span>
          <span class="n">intent</span><span class="o">.</span><span class="na">getIntExtra</span><span class="o">(</span><span class="nc">BatteryManager</span><span class="o">.</span><span class="na">EXTRA_SCALE</span><span class="o">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">batteryLevel</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div>    </div>

    <p>Finally, complete the <code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code> method added earlier.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">call</code> argument. The implementation of
this platform method calls the Android code written
in the previous step, and returns a response for both
the success and error cases using the <code class="language-plaintext highlighter-rouge">result</code> argument.
If an unknown method is called, report that instead.</p>

    <p>Remove the following code:</p>

    <!--code-excerpt "MainActivity.java" title-->
    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>          <span class="o">(</span><span class="n">call</span><span class="o">,</span> <span class="n">result</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// This method is invoked on the main thread.</span>
            <span class="c1">// TODO</span>
          <span class="o">}</span>
</code></pre></div>    </div>

    <p>And replace with the following:</p>

    <!--code-excerpt "MainActivity.java" title-->
    <div class="language-java highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>          <span class="o">(</span><span class="n">call</span><span class="o">,</span> <span class="n">result</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// This method is invoked on the main thread.</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">call</span><span class="o">.</span><span class="na">method</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"getBatteryLevel"</span><span class="o">))</span> <span class="o">{</span>
              <span class="kt">int</span> <span class="n">batteryLevel</span> <span class="o">=</span> <span class="n">getBatteryLevel</span><span class="o">();</span>

              <span class="k">if</span> <span class="o">(</span><span class="n">batteryLevel</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">result</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">batteryLevel</span><span class="o">);</span>
              <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">result</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"UNAVAILABLE"</span><span class="o">,</span> <span class="s">"Battery level not available."</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
              <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
              <span class="n">result</span><span class="o">.</span><span class="na">notImplemented</span><span class="o">();</span>
            <span class="o">}</span>
          <span class="o">}</span>
</code></pre></div>    </div>

  </div>

</div>

<p>You should now be able to run the app on Android. If using the Android
Emulator, set the battery level in the Extended Controls panel
accessible from the <strong>…</strong> button in the toolbar.</p>

<h3 id="step-4-add-an-ios-platform-specific-implementation">
<a class="anchor" href="#step-4-add-an-ios-platform-specific-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 4: Add an iOS platform-specific implementation</h3>

<ul class="nav nav-tabs sample-code-tabs" id="ios-channel-language" role="tablist">
<li class="nav-item">
  <a class="nav-link active" id="ios-channel-swift" href="#ios-channel-swift-tab" role="tab" aria-controls="ios-channel-swift" aria-selected="true">Swift</a>
</li>

<li class="nav-item">
  <a class="nav-link " id="ios-channel-objective-c" href="#ios-channel-objective-c-tab" role="tab" aria-controls="ios-channel-objective-c" aria-selected="true">Objective-C</a>
</li>
</ul>
<div class="tab-content">

<div class="tab-pane active" id="ios-channel-swift-tab" role="tabpanel" aria-labelledby="ios-channel-swift-tab">

    <p>Start by opening the iOS host portion of your Flutter app in Xcode:</p>

    <ol>
      <li>
        <p>Start Xcode.</p>
      </li>
      <li>
        <p>Select the menu item <strong>File &gt; Open…</strong>.</p>
      </li>
      <li>
        <p>Navigate to the directory holding your Flutter app, and select the <strong>ios</strong>
folder inside it. Click <strong>OK</strong>.</p>
      </li>
    </ol>

    <p>Add support for Swift in the standard template setup that uses Objective-C:</p>

    <ol>
      <li>
        <p><strong>Expand Runner &gt; Runner</strong> in the Project navigator.</p>
      </li>
      <li>
        <p>Open the file <code class="language-plaintext highlighter-rouge">AppDelegate.swift</code> located under <strong>Runner &gt; Runner</strong>
in the Project navigator.</p>
      </li>
    </ol>

    <p>Override the <code class="language-plaintext highlighter-rouge">application:didFinishLaunchingWithOptions:</code> function and create
a <code class="language-plaintext highlighter-rouge">FlutterMethodChannel</code> tied to the channel name
<code class="language-plaintext highlighter-rouge">samples.flutter.dev/battery</code>:</p>

    <!--code-excerpt "AppDelegate.swift" title-->
    <div class="language-swift highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kd">@UIApplicationMain</span>
<span class="kd">@objc</span> <span class="kd">class</span> <span class="kt">AppDelegate</span><span class="p">:</span> <span class="kt">FlutterAppDelegate</span> <span class="p">{</span>
  <span class="k">override</span> <span class="kd">func</span> <span class="nf">application</span><span class="p">(</span>
    <span class="n">_</span> <span class="nv">application</span><span class="p">:</span> <span class="kt">UIApplication</span><span class="p">,</span>
    <span class="n">didFinishLaunchingWithOptions</span> <span class="nv">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="kt">UIApplication</span><span class="o">.</span><span class="kt">LaunchOptionsKey</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">controller</span> <span class="p">:</span> <span class="kt">FlutterViewController</span> <span class="o">=</span> <span class="n">window</span><span class="p">?</span><span class="o">.</span><span class="n">rootViewController</span> <span class="k">as!</span> <span class="kt">FlutterViewController</span>
    <span class="k">let</span> <span class="nv">batteryChannel</span> <span class="o">=</span> <span class="kt">FlutterMethodChannel</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"samples.flutter.dev/battery"</span><span class="p">,</span>
                                              <span class="nv">binaryMessenger</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">binaryMessenger</span><span class="p">)</span>
    <span class="n">batteryChannel</span><span class="o">.</span><span class="nf">setMethodCallHandler</span><span class="p">({</span>
      <span class="p">(</span><span class="nv">call</span><span class="p">:</span> <span class="kt">FlutterMethodCall</span><span class="p">,</span> <span class="nv">result</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">FlutterResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
      <span class="c1">// This method is invoked on the UI thread.</span>
      <span class="c1">// Handle battery messages.</span>
    <span class="p">})</span>

    <span class="kt">GeneratedPluginRegistrant</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">super</span><span class="o">.</span><span class="nf">application</span><span class="p">(</span><span class="n">application</span><span class="p">,</span> <span class="nv">didFinishLaunchingWithOptions</span><span class="p">:</span> <span class="n">launchOptions</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Next, add the iOS Swift code that uses the iOS battery APIs to retrieve
the battery level. This code is exactly the same as you
would write in a native iOS app.</p>

    <p>Add the following as a new method at the bottom of <code class="language-plaintext highlighter-rouge">AppDelegate.swift</code>:</p>

    <!--code-excerpt "AppDelegate.swift" title-->
    <div class="language-swift highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">func</span> <span class="nf">receiveBatteryLevel</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="kt">FlutterResult</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">device</span> <span class="o">=</span> <span class="kt">UIDevice</span><span class="o">.</span><span class="n">current</span>
  <span class="n">device</span><span class="o">.</span><span class="n">isBatteryMonitoringEnabled</span> <span class="o">=</span> <span class="kc">true</span>
  <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">batteryState</span> <span class="o">==</span> <span class="kt">UIDevice</span><span class="o">.</span><span class="kt">BatteryState</span><span class="o">.</span><span class="n">unknown</span> <span class="p">{</span>
    <span class="nf">result</span><span class="p">(</span><span class="kt">FlutterError</span><span class="p">(</span><span class="nv">code</span><span class="p">:</span> <span class="s">"UNAVAILABLE"</span><span class="p">,</span>
                        <span class="nv">message</span><span class="p">:</span> <span class="s">"Battery level not available."</span><span class="p">,</span>
                        <span class="nv">details</span><span class="p">:</span> <span class="kc">nil</span><span class="p">))</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">result</span><span class="p">(</span><span class="kt">Int</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">batteryLevel</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Finally, complete the <code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code> method added earlier.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">call</code> argument.
The implementation of this platform method calls
the iOS code written in the previous step. If an unknown method
is called, report that instead.</p>

    <!--code-excerpt "AppDelegate.swift" title-->
    <div class="language-swift highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">batteryChannel</span><span class="o">.</span><span class="nf">setMethodCallHandler</span><span class="p">({</span>
  <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="nv">call</span><span class="p">:</span> <span class="kt">FlutterMethodCall</span><span class="p">,</span> <span class="nv">result</span><span class="p">:</span> <span class="kt">FlutterResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span> <span class="k">in</span>
  <span class="c1">// This method is invoked on the UI thread.</span>
  <span class="k">guard</span> <span class="n">call</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"getBatteryLevel"</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">result</span><span class="p">(</span><span class="kt">FlutterMethodNotImplemented</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="p">}</span>
  <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="nf">receiveBatteryLevel</span><span class="p">(</span><span class="nv">result</span><span class="p">:</span> <span class="n">result</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div>    </div>

  </div>


<div class="tab-pane " id="ios-channel-objective-c-tab" role="tabpanel" aria-labelledby="ios-channel-objective-c-tab">

    <p>Start by opening the iOS host portion of the Flutter app in Xcode:</p>

    <ol>
      <li>
        <p>Start Xcode.</p>
      </li>
      <li>
        <p>Select the menu item <strong>File &gt; Open…</strong>.</p>
      </li>
      <li>
        <p>Navigate to the directory holding your Flutter app,
and select the <strong>ios</strong> folder inside it. Click <strong>OK</strong>.</p>
      </li>
      <li>
        <p>Make sure the Xcode projects builds without errors.</p>
      </li>
      <li>
        <p>Open the file <code class="language-plaintext highlighter-rouge">AppDelegate.m</code>, located under <strong>Runner &gt; Runner</strong>
in the Project navigator.</p>
      </li>
    </ol>

    <p>Create a <code class="language-plaintext highlighter-rouge">FlutterMethodChannel</code> and add a handler inside the <code class="language-plaintext highlighter-rouge">application
didFinishLaunchingWithOptions:</code> method.
Make sure to use the same channel name
as was used on the Flutter client side.</p>

    <!--code-excerpt "AppDelegate.m" title-->
    <div class="language-objectivec highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="cp">#import &lt;Flutter/Flutter.h&gt;
#import "GeneratedPluginRegistrant.h"
</span>
<span class="k">@implementation</span> <span class="nc">AppDelegate</span>
<span class="k">-</span> <span class="p">(</span><span class="n">BOOL</span><span class="p">)</span><span class="nf">application</span><span class="p">:(</span><span class="n">UIApplication</span><span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions</span><span class="p">:(</span><span class="n">NSDictionary</span><span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span> <span class="p">{</span>
  <span class="n">FlutterViewController</span><span class="o">*</span> <span class="n">controller</span> <span class="o">=</span> <span class="p">(</span><span class="n">FlutterViewController</span><span class="o">*</span><span class="p">)</span><span class="n">self</span><span class="p">.</span><span class="n">window</span><span class="p">.</span><span class="n">rootViewController</span><span class="p">;</span>

  <span class="n">FlutterMethodChannel</span><span class="o">*</span> <span class="n">batteryChannel</span> <span class="o">=</span> <span class="p">[</span><span class="n">FlutterMethodChannel</span>
                                          <span class="nl">methodChannelWithName:</span><span class="s">@"samples.flutter.dev/battery"</span>
                                          <span class="nl">binaryMessenger:</span><span class="n">controller</span><span class="p">.</span><span class="nf">binaryMessenger</span><span class="p">];</span>

  <span class="p">[</span><span class="n">batteryChannel</span> <span class="nf">setMethodCallHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">FlutterMethodCall</span><span class="o">*</span> <span class="n">call</span><span class="p">,</span> <span class="n">FlutterResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// This method is invoked on the UI thread.</span>
    <span class="c1">// TODO</span>
  <span class="p">}];</span>

  <span class="p">[</span><span class="n">GeneratedPluginRegistrant</span> <span class="nf">registerWithRegistry</span><span class="p">:</span><span class="n">self</span><span class="p">];</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">super</span> <span class="nf">application</span><span class="p">:</span><span class="n">application</span> <span class="nf">didFinishLaunchingWithOptions</span><span class="p">:</span><span class="n">launchOptions</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Next, add the iOS ObjectiveC code that uses the iOS battery APIs to
retrieve the battery level. This code is exactly the same as you
would write in a native iOS app.</p>

    <p>Add the following method in the <code class="language-plaintext highlighter-rouge">AppDelegate</code> class, just before <code class="language-plaintext highlighter-rouge">@end</code>:</p>

    <!--code-excerpt "AppDelegate.m" title-->
    <div class="language-objectivec highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">-</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">getBatteryLevel</span> <span class="p">{</span>
  <span class="n">UIDevice</span><span class="o">*</span> <span class="n">device</span> <span class="o">=</span> <span class="n">UIDevice</span><span class="p">.</span><span class="n">currentDevice</span><span class="p">;</span>
  <span class="n">device</span><span class="p">.</span><span class="n">batteryMonitoringEnabled</span> <span class="o">=</span> <span class="nb">YES</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">batteryState</span> <span class="o">==</span> <span class="n">UIDeviceBatteryStateUnknown</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">device</span><span class="p">.</span><span class="n">batteryLevel</span> <span class="o">*</span> <span class="mi">100</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>

    <p>Finally, complete the <code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code> method added earlier.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">call</code> argument. The implementation of
this platform method calls the iOS code written in the previous step,
and returns a response for both the success and error cases using
the <code class="language-plaintext highlighter-rouge">result</code> argument. If an unknown method is called, report that instead.</p>

    <!--code-excerpt "AppDelegate.m" title-->
    <div class="language-objectivec highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="n">__weak</span> <span class="n">typeof</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="n">weakSelf</span> <span class="o">=</span> <span class="n">self</span><span class="p">;</span>
<span class="p">[</span><span class="n">batteryChannel</span> <span class="nf">setMethodCallHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="n">FlutterMethodCall</span><span class="o">*</span> <span class="n">call</span><span class="p">,</span> <span class="n">FlutterResult</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// This method is invoked on the UI thread.</span>
  <span class="k">if</span> <span class="p">([</span><span class="s">@"getBatteryLevel"</span> <span class="nf">isEqualToString</span><span class="p">:</span><span class="n">call</span><span class="p">.</span><span class="n">method</span><span class="p">])</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">batteryLevel</span> <span class="o">=</span> <span class="p">[</span><span class="n">weakSelf</span> <span class="nf">getBatteryLevel</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">batteryLevel</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">result</span><span class="p">([</span><span class="n">FlutterError</span> <span class="nf">errorWithCode</span><span class="p">:</span><span class="s">@"UNAVAILABLE"</span>
                                 <span class="nl">message:</span><span class="s">@"Battery level not available."</span>
                                 <span class="nl">details:</span><span class="nb">nil</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">result</span><span class="p">(</span><span class="err">@</span><span class="p">(</span><span class="n">batteryLevel</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">result</span><span class="p">(</span><span class="n">FlutterMethodNotImplemented</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}];</span>
</code></pre></div>    </div>

  </div>

</div>

<p>You should now be able to run the app on iOS.
If using the iOS Simulator,
note that it doesn’t support battery APIs,
and the app displays ‘Battery level not available’.</p>

<h3 id="step-5-add-a-windows-platform-specific-implementation">
<a class="anchor" href="#step-5-add-a-windows-platform-specific-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 5: Add a Windows platform-specific implementation</h3>

<p>Start by opening the Windows host portion of your Flutter app in Visual Studio:</p>

<ol>
  <li>
    <p>Run <code class="language-plaintext highlighter-rouge">flutter build windows</code> in your project directory once to generate
the Visual Studio solution file.</p>
  </li>
  <li>
    <p>Start Visual Studio.</p>
  </li>
  <li>
    <p>Select <strong>Open a project or solution</strong>.</p>
  </li>
  <li>
    <p>Navigate to the directory holding your Flutter app, then into the <strong>build</strong>
folder, then the <strong>windows</strong> folder, then select the <code class="language-plaintext highlighter-rouge">batterylevel.sln</code> file.
Click <strong>Open</strong>.</p>
  </li>
</ol>

<p>Add the C++ implementation of the platform channel method:</p>

<ol>
  <li>
    <p>Expand <strong>batterylevel &gt; Source Files</strong> in the Solution Explorer.</p>
  </li>
  <li>
    <p>Open the file <code class="language-plaintext highlighter-rouge">flutter_window.cpp</code>.</p>
  </li>
</ol>

<p>First, add the necessary includes to the top of the file, just
after <code class="language-plaintext highlighter-rouge">#include "flutter_window.h"</code>:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;flutter/event_channel.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;flutter/event_sink.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;flutter/event_stream_handler_functions.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;flutter/method_channel.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;flutter/standard_method_codec.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;windows.h&gt;</span><span class="cp">
</span>
<span class="cp">#include</span> <span class="cpf">&lt;memory&gt;</span><span class="cp">
</span></code></pre></div></div>

<p>Edit the <code class="language-plaintext highlighter-rouge">FlutterWindow::OnCreate</code> method and create
a <code class="language-plaintext highlighter-rouge">flutter::MethodChannel</code> tied to the channel name
<code class="language-plaintext highlighter-rouge">samples.flutter.dev/battery</code>:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="n">FlutterWindow</span><span class="o">::</span><span class="n">OnCreate</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="n">RegisterPlugins</span><span class="p">(</span><span class="n">flutter_controller_</span><span class="o">-&gt;</span><span class="n">engine</span><span class="p">());</span>

  <span class="n">flutter</span><span class="o">::</span><span class="n">MethodChannel</span><span class="o">&lt;&gt;</span> <span class="n">channel</span><span class="p">(</span>
      <span class="n">flutter_controller_</span><span class="o">-&gt;</span><span class="n">engine</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">messenger</span><span class="p">(),</span> <span class="s">"samples.flutter.dev/battery"</span><span class="p">,</span>
      <span class="o">&amp;</span><span class="n">flutter</span><span class="o">::</span><span class="n">StandardMethodCodec</span><span class="o">::</span><span class="n">GetInstance</span><span class="p">());</span>
  <span class="n">channel</span><span class="p">.</span><span class="n">SetMethodCallHandler</span><span class="p">(</span>
      <span class="p">[](</span><span class="k">const</span> <span class="n">flutter</span><span class="o">::</span><span class="n">MethodCall</span><span class="o">&lt;&gt;&amp;</span> <span class="n">call</span><span class="p">,</span>
         <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">flutter</span><span class="o">::</span><span class="n">MethodResult</span><span class="o">&lt;&gt;&gt;</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO</span>
      <span class="p">});</span>

  <span class="n">SetChildContent</span><span class="p">(</span><span class="n">flutter_controller_</span><span class="o">-&gt;</span><span class="n">view</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">GetNativeWindow</span><span class="p">());</span>
  <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Next, add the C++ code that uses the Windows battery APIs to
retrieve the battery level. This code is exactly the same as
you would write in a native Windows application.</p>

<p>Add the following as a new function at the top of
<code class="language-plaintext highlighter-rouge">flutter_window.cpp</code> just after the <code class="language-plaintext highlighter-rouge">#include</code> section:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">int</span> <span class="nf">GetBatteryLevel</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">SYSTEM_POWER_STATUS</span> <span class="n">status</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">GetSystemPowerStatus</span><span class="p">(</span><span class="o">&amp;</span><span class="n">status</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">status</span><span class="p">.</span><span class="n">BatteryLifePercent</span> <span class="o">==</span> <span class="mi">255</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">status</span><span class="p">.</span><span class="n">BatteryLifePercent</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Finally, complete the <code class="language-plaintext highlighter-rouge">setMethodCallHandler()</code> method added earlier.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel()</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">call</code> argument.
The implementation of this platform method calls
the Windows code written in the previous step. If an unknown method
is called, report that instead.</p>

<p>Remove the following code:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">channel</span><span class="p">.</span><span class="n">SetMethodCallHandler</span><span class="p">(</span>
      <span class="p">[](</span><span class="k">const</span> <span class="n">flutter</span><span class="o">::</span><span class="n">MethodCall</span><span class="o">&lt;&gt;&amp;</span> <span class="n">call</span><span class="p">,</span>
         <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">flutter</span><span class="o">::</span><span class="n">MethodResult</span><span class="o">&lt;&gt;&gt;</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// TODO</span>
      <span class="p">});</span>
</code></pre></div></div>

<p>And replace with the following:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="n">channel</span><span class="p">.</span><span class="n">SetMethodCallHandler</span><span class="p">(</span>
      <span class="p">[](</span><span class="k">const</span> <span class="n">flutter</span><span class="o">::</span><span class="n">MethodCall</span><span class="o">&lt;&gt;&amp;</span> <span class="n">call</span><span class="p">,</span>
         <span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">flutter</span><span class="o">::</span><span class="n">MethodResult</span><span class="o">&lt;&gt;&gt;</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">call</span><span class="p">.</span><span class="n">method_name</span><span class="p">()</span> <span class="o">==</span> <span class="s">"getBatteryLevel"</span><span class="p">)</span> <span class="p">{</span>
          <span class="kt">int</span> <span class="n">battery_level</span> <span class="o">=</span> <span class="n">GetBatteryLevel</span><span class="p">();</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">battery_level</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">result</span><span class="o">-&gt;</span><span class="n">Success</span><span class="p">(</span><span class="n">battery_level</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">result</span><span class="o">-&gt;</span><span class="n">Error</span><span class="p">(</span><span class="s">"UNAVAILABLE"</span><span class="p">,</span> <span class="s">"Battery level not available."</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="n">result</span><span class="o">-&gt;</span><span class="n">NotImplemented</span><span class="p">();</span>
        <span class="p">}</span>
      <span class="p">});</span>
</code></pre></div></div>

<p>You should now be able to run the application on Windows.
If your device doesn’t have a battery,
it displays ‘Battery level not available’.</p>

<h3 id="step-6-add-a-linux-platform-specific-implementation">
<a class="anchor" href="#step-6-add-a-linux-platform-specific-implementation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Step 6: Add a Linux platform-specific implementation</h3>

<p>For this example you need to install the <code class="language-plaintext highlighter-rouge">upower</code> developer headers.
This is likely available from your distribution, for example with:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install </span>libupower-glib-dev
</code></pre></div></div>

<p>Start by opening the Linux host portion of your Flutter app in the editor
of your choice. The instructions below are for Visual Studio Code with the
“C/C++” and “CMake” extensions installed, but can be adjusted for other IDEs.</p>

<ol>
  <li>
    <p>Launch Visual Studio Code.</p>
  </li>
  <li>
    <p>Open the <strong>linux</strong> directory inside your project.</p>
  </li>
  <li>
    <p>Choose <strong>Yes</strong> in the prompt asking: <code class="language-plaintext highlighter-rouge">Would you like to configure project "linux"?</code>.
This enables C++ autocomplete.</p>
  </li>
  <li>
    <p>Open the file <code class="language-plaintext highlighter-rouge">my_application.cc</code>.</p>
  </li>
</ol>

<p>First, add the necessary includes to the top of the file, just
after <code class="language-plaintext highlighter-rouge">#include &lt;flutter_linux/flutter_linux.h</code>:</p>

<!--code-excerpt "my_application.cc" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;math.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;upower.h&gt;</span><span class="cp">
</span></code></pre></div></div>

<p>Add an <code class="language-plaintext highlighter-rouge">FlMethodChannel</code> to the <code class="language-plaintext highlighter-rouge">_MyApplication</code> struct:</p>

<!--code-excerpt "my_application.cc" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">_MyApplication</span> <span class="p">{</span>
  <span class="n">GtkApplication</span> <span class="n">parent_instance</span><span class="p">;</span>
  <span class="kt">char</span><span class="o">**</span> <span class="n">dart_entrypoint_arguments</span><span class="p">;</span>
  <span class="n">FlMethodChannel</span><span class="o">*</span> <span class="n">battery_channel</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Make sure to clean it up in <code class="language-plaintext highlighter-rouge">my_application_dispose</code>:</p>

<!--code-excerpt "my_application.cc" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">my_application_dispose</span><span class="p">(</span><span class="n">GObject</span><span class="o">*</span> <span class="n">object</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">MyApplication</span><span class="o">*</span> <span class="n">self</span> <span class="o">=</span> <span class="n">MY_APPLICATION</span><span class="p">(</span><span class="n">object</span><span class="p">);</span>
  <span class="n">g_clear_pointer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">dart_entrypoint_arguments</span><span class="p">,</span> <span class="n">g_strfreev</span><span class="p">);</span>
  <span class="n">g_clear_object</span><span class="p">(</span><span class="o">&amp;</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">battery_channel</span><span class="p">);</span>
  <span class="n">G_OBJECT_CLASS</span><span class="p">(</span><span class="n">my_application_parent_class</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">dispose</span><span class="p">(</span><span class="n">object</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Edit the <code class="language-plaintext highlighter-rouge">my_application_activate</code> method and initialize
<code class="language-plaintext highlighter-rouge">battery_channel</code> using the channel name
<code class="language-plaintext highlighter-rouge">samples.flutter.dev/battery</code>, just after the call to
<code class="language-plaintext highlighter-rouge">fl_register_plugins</code>:</p>

<!--code-excerpt "my_application.cc" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">my_application_activate</span><span class="p">(</span><span class="n">GApplication</span><span class="o">*</span> <span class="n">application</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="n">fl_register_plugins</span><span class="p">(</span><span class="n">FL_PLUGIN_REGISTRY</span><span class="p">(</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">view</span><span class="p">));</span>

  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">FlStandardMethodCodec</span><span class="p">)</span> <span class="n">codec</span> <span class="o">=</span> <span class="n">fl_standard_method_codec_new</span><span class="p">();</span>
  <span class="n">self</span><span class="o">-&gt;</span><span class="n">battery_channel</span> <span class="o">=</span> <span class="n">fl_method_channel_new</span><span class="p">(</span>
      <span class="n">fl_engine_get_binary_messenger</span><span class="p">(</span><span class="n">fl_view_get_engine</span><span class="p">(</span><span class="n">view</span><span class="p">)),</span>
      <span class="s">"samples.flutter.dev/battery"</span><span class="p">,</span> <span class="n">FL_METHOD_CODEC</span><span class="p">(</span><span class="n">codec</span><span class="p">));</span>
  <span class="n">fl_method_channel_set_method_call_handler</span><span class="p">(</span>
      <span class="n">self</span><span class="o">-&gt;</span><span class="n">battery_channel</span><span class="p">,</span> <span class="n">battery_method_call_handler</span><span class="p">,</span> <span class="n">self</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">);</span>

  <span class="n">gtk_widget_grab_focus</span><span class="p">(</span><span class="n">GTK_WIDGET</span><span class="p">(</span><span class="n">self</span><span class="o">-&gt;</span><span class="n">view</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Next, add the C code that uses the Linux battery APIs to
retrieve the battery level. This code is exactly the same as
you would write in a native Linux application.</p>

<p>Add the following as a new function at the top of
<code class="language-plaintext highlighter-rouge">my_application.cc</code> just after the <code class="language-plaintext highlighter-rouge">G_DEFINE_TYPE</code> line:</p>

<!--code-excerpt "my_application.cc" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="n">FlMethodResponse</span><span class="o">*</span> <span class="nf">get_battery_level</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Find the first available battery and report that.</span>
  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">UpClient</span><span class="p">)</span> <span class="n">up_client</span> <span class="o">=</span> <span class="n">up_client_new</span><span class="p">();</span>
  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">GPtrArray</span><span class="p">)</span> <span class="n">devices</span> <span class="o">=</span> <span class="n">up_client_get_devices2</span><span class="p">(</span><span class="n">up_client</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">devices</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">FL_METHOD_RESPONSE</span><span class="p">(</span><span class="n">fl_method_error_response_new</span><span class="p">(</span>
        <span class="s">"UNAVAILABLE"</span><span class="p">,</span> <span class="s">"Device does not have a battery."</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">UpDevice</span><span class="o">*</span> <span class="n">device</span> <span class="o">=</span> <span class="p">(</span><span class="n">UpDevice</span><span class="o">*</span><span class="p">)(</span><span class="n">g_ptr_array_index</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="kt">double</span> <span class="n">percentage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">g_object_get</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="s">"percentage"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">percentage</span><span class="p">,</span> <span class="n">nullptr</span><span class="p">);</span>

  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">FlValue</span><span class="p">)</span> <span class="n">result</span> <span class="o">=</span>
      <span class="n">fl_value_new_int</span><span class="p">(</span><span class="n">static_cast</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">round</span><span class="p">(</span><span class="n">percentage</span><span class="p">)));</span>
  <span class="k">return</span> <span class="n">FL_METHOD_RESPONSE</span><span class="p">(</span><span class="n">fl_method_success_response_new</span><span class="p">(</span><span class="n">result</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Finally, add the <code class="language-plaintext highlighter-rouge">battery_method_call_handler</code> function referenced
in the earlier call to <code class="language-plaintext highlighter-rouge">fl_method_channel_set_method_call_handler</code>.
You need to handle a single platform method, <code class="language-plaintext highlighter-rouge">getBatteryLevel</code>,
so test for that in the <code class="language-plaintext highlighter-rouge">method_call</code> argument.
The implementation of this function calls
the Linux code written in the previous step. If an unknown method
is called, report that instead.</p>

<p>Add the following code after the <code class="language-plaintext highlighter-rouge">get_battery_level</code> function:</p>

<!--code-excerpt "flutter_window.cpp" title-->
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kt">void</span> <span class="nf">battery_method_call_handler</span><span class="p">(</span><span class="n">FlMethodChannel</span><span class="o">*</span> <span class="n">channel</span><span class="p">,</span>
                                        <span class="n">FlMethodCall</span><span class="o">*</span> <span class="n">method_call</span><span class="p">,</span>
                                        <span class="n">gpointer</span> <span class="n">user_data</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">FlMethodResponse</span><span class="p">)</span> <span class="n">response</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">fl_method_call_get_name</span><span class="p">(</span><span class="n">method_call</span><span class="p">),</span> <span class="s">"getBatteryLevel"</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">get_battery_level</span><span class="p">();</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">FL_METHOD_RESPONSE</span><span class="p">(</span><span class="n">fl_method_not_implemented_response_new</span><span class="p">());</span>
  <span class="p">}</span>

  <span class="n">g_autoptr</span><span class="p">(</span><span class="n">GError</span><span class="p">)</span> <span class="n">error</span> <span class="o">=</span> <span class="n">nullptr</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fl_method_call_respond</span><span class="p">(</span><span class="n">method_call</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">g_warning</span><span class="p">(</span><span class="s">"Failed to send response: %s"</span><span class="p">,</span> <span class="n">error</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You should now be able to run the application on Linux.
If your device doesn’t have a battery,
it displays ‘Battery level not available’.</p>

<h2 id="pigeon">
<a class="anchor" href="#pigeon" aria-hidden="true"><span class="octicon octicon-link"></span></a>Typesafe platform channels using Pigeon</h2>

<p>The previous example uses <code class="language-plaintext highlighter-rouge">MethodChannel</code>
to communicate between the host and client,
which isn’t typesafe. Calling and receiving
messages depends on the host and client declaring
the same arguments and datatypes in order for messages to work.
You can use the <a href="https://pub.dev/packages/pigeon">Pigeon</a> package as
an alternative to <code class="language-plaintext highlighter-rouge">MethodChannel</code>
to generate code that sends messages in a
structured, typesafe manner.</p>

<p>With <a href="https://pub.dev/packages/pigeon">Pigeon</a>, the messaging protocol is defined
in a subset of Dart that then generates messaging
code for Android or iOS. You can find a more complete
example and more information on the <a href="https://pub.dev/packages/pigeon"><code class="language-plaintext highlighter-rouge">pigeon</code></a>
page on pub.dev.</p>

<p>Using <a href="https://pub.dev/packages/pigeon">Pigeon</a> eliminates the need to match
strings between host and client
for the names and datatypes of messages.
It supports: nested classes, grouping
messages into APIs, generation of
asynchronous wrapper code and sending messages
in either direction. The generated code is readable
and guarantees there are no conflicts between
multiple clients of different versions.
Supported languages are Objective-C, Java, Kotlin,
and Swift (with Objective-C interop).</p>

<h3 id="pigeon-example">
<a class="anchor" href="#pigeon-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pigeon example</h3>

<p><strong>Pigeon file:</strong></p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">import 'package:pigeon/pigeon.dart';

class SearchRequest {
  final String query;

  SearchRequest({required this.query});
}

class SearchReply {
  final String result;

  SearchReply({required this.result});
}

@HostApi()
abstract class Api {
  @async
  SearchReply search(SearchRequest request);
}</code></pre></div>
</div>

<p><strong>Dart usage:</strong></p>

<div class="code-excerpt">
<div class="code-excerpt__code"><pre><code class="dart prettyprint lang-dart">import 'generated_pigeon.dart';

Future&lt;void&gt; onClick() async {
  SearchRequest request = SearchRequest(query: 'test');
  Api api = SomeApi();
  SearchReply reply = await api.search(request);
  print('reply: ${reply.result}');
}</code></pre></div>
</div>

<h2 id="separate">
<a class="anchor" href="#separate" aria-hidden="true"><span class="octicon octicon-link"></span></a>Separate platform-specific code from UI code</h2>

<p>If you expect to use your platform-specific code
in multiple Flutter apps, you might consider
separating the code into a platform plugin located
in a directory outside your main application.
See <a href="http://0.0.0.0:4002/development/packages-and-plugins/developing-packages">developing packages</a> for details.</p>

<h2 id="publish">
<a class="anchor" href="#publish" aria-hidden="true"><span class="octicon octicon-link"></span></a>Publish platform-specific code as a package</h2>

<p>To share your platform-specific code with other developers
in the Flutter ecosystem, see <a href="http://0.0.0.0:4002/development/packages-and-plugins/developing-packages#publish">publishing packages</a>.</p>

<h2 id="custom-channels-and-codecs">
<a class="anchor" href="#custom-channels-and-codecs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Custom channels and codecs</h2>

<p>Besides the above mentioned <code class="language-plaintext highlighter-rouge">MethodChannel</code>,
you can also use the more basic
<a href="https://api.flutter.dev/flutter/services/BasicMessageChannel-class.html"><code class="language-plaintext highlighter-rouge">BasicMessageChannel</code></a>, which supports basic,
asynchronous message passing using a custom message codec.
You can also use the specialized <a href="https://api.flutter.dev/flutter/services/BinaryCodec-class.html"><code class="language-plaintext highlighter-rouge">BinaryCodec</code></a>,
<a href="https://api.flutter.dev/flutter/services/StringCodec-class.html"><code class="language-plaintext highlighter-rouge">StringCodec</code></a>, and <a href="https://api.flutter.dev/flutter/services/JSONMessageCodec-class.html"><code class="language-plaintext highlighter-rouge">JSONMessageCodec</code></a>
classes, or create your own codec.</p>

<p>You might also check out an example of a custom codec
in the <a href="https://github.com/FirebaseExtended/flutterfire/blob/master/packages/cloud_firestore/cloud_firestore_platform_interface/lib/src/method_channel/utils/firestore_message_codec.dart"><code class="language-plaintext highlighter-rouge">cloud_firestore</code></a> plugin,
which is able to serialize and deserialize many more
types than the default types.</p>

<h2 id="channels-and-platform-threading">
<a class="anchor" href="#channels-and-platform-threading" aria-hidden="true"><span class="octicon octicon-link"></span></a>Channels and platform threading</h2>

<p>When invoking channels on the platform side destined for Flutter,
invoke them on the platform’s main thread.
When invoking channels in Flutter destined for the platform side,
either invoke them from any <code class="language-plaintext highlighter-rouge">Isolate</code> that is the root
<code class="language-plaintext highlighter-rouge">Isolate</code>, <em>or</em> that is registered as a background <code class="language-plaintext highlighter-rouge">Isolate</code>.
The handlers for the platform side can execute on the platform’s main thread
or they can execute on a background thread if using a Task Queue.
You can invoke the platform side handlers asynchronously
and on any thread when the Task Queue API is available;
otherwise, they must be invoked on the platform thread.</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  On Android, the platform’s main thread is sometimes
  called the “main thread”, but it is technically defined
  as <a href="https://developer.android.com/guide/components/processes-and-threads#Threads">the UI thread</a>. Annotate methods that need
  to be run on the UI thread with <code class="language-plaintext highlighter-rouge">@UiThread</code>.
  On iOS, this thread is officially
  referred to as <a href="https://developer.apple.com/documentation/uikit?language=objc">the main thread</a>.</p>
</aside>

<h3 id="using-plugins-and-channels-from-background-isolates">
<a class="anchor" href="#using-plugins-and-channels-from-background-isolates" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using plugins and channels from background isolates</h3>

<p>Plugins and channels can be used by any <code class="language-plaintext highlighter-rouge">Isolate</code>, but that <code class="language-plaintext highlighter-rouge">Isolate</code> has to be
a root <code class="language-plaintext highlighter-rouge">Isolate</code> (the one created by Flutter) or registered as a background
<code class="language-plaintext highlighter-rouge">Isolate</code> for a root <code class="language-plaintext highlighter-rouge">Isolate</code>.</p>

<p>The following example shows how to register a background <code class="language-plaintext highlighter-rouge">Isolate</code> in order to
use a plugin from a background <code class="language-plaintext highlighter-rouge">Isolate</code>.</p>

<div class="language-dart highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="s">'package:flutter/services.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>

<span class="kt">void</span> <span class="nf">_isolateMain</span><span class="p">(</span><span class="n">RootIsolateToken</span> <span class="n">rootIsolateToken</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="n">BackgroundIsolateBinaryMessenger</span><span class="o">.</span><span class="na">ensureInitialized</span><span class="p">(</span><span class="n">rootIsolateToken</span><span class="p">);</span>
  <span class="n">SharedPreferences</span> <span class="n">sharedPreferences</span> <span class="o">=</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">();</span>
  <span class="n">print</span><span class="p">(</span><span class="n">sharedPreferences</span><span class="o">.</span><span class="na">getBool</span><span class="p">(</span><span class="s">'isDebug'</span><span class="p">));</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">RootIsolateToken</span> <span class="n">rootIsolateToken</span> <span class="o">=</span> <span class="n">RootIsolateToken</span><span class="o">.</span><span class="na">instance</span><span class="o">!</span><span class="p">;</span>
  <span class="n">Isolate</span><span class="o">.</span><span class="na">spawn</span><span class="p">(</span><span class="n">_isolateMain</span><span class="p">,</span> <span class="n">rootIsolateToken</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="executing-channel-handlers-on-background-threads">
<a class="anchor" href="#executing-channel-handlers-on-background-threads" aria-hidden="true"><span class="octicon octicon-link"></span></a>Executing channel handlers on background threads</h3>

<p>In order for a channel’s platform side handler to
execute on a background thread, you must use the
Task Queue API. Currently this feature is only
supported on iOS and Android.</p>

<p>In Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onAttachedToEngine</span><span class="o">(</span><span class="nd">@NonNull</span> <span class="nc">FlutterPluginBinding</span> <span class="n">binding</span><span class="o">)</span> <span class="o">{</span>
  <span class="nc">BinaryMessenger</span> <span class="n">messenger</span> <span class="o">=</span> <span class="n">binding</span><span class="o">.</span><span class="na">getBinaryMessenger</span><span class="o">();</span>
  <span class="nc">BinaryMessenger</span><span class="o">.</span><span class="na">TaskQueue</span> <span class="n">taskQueue</span> <span class="o">=</span>
      <span class="n">messenger</span><span class="o">.</span><span class="na">makeBackgroundTaskQueue</span><span class="o">();</span>
  <span class="n">channel</span> <span class="o">=</span>
      <span class="k">new</span> <span class="nf">MethodChannel</span><span class="o">(</span>
          <span class="n">messenger</span><span class="o">,</span>
          <span class="s">"com.example.foo"</span><span class="o">,</span>
          <span class="nc">StandardMethodCodec</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">,</span>
          <span class="n">taskQueue</span><span class="o">);</span>
  <span class="n">channel</span><span class="o">.</span><span class="na">setMethodCallHandler</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In Kotlin:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="k">fun</span> <span class="nf">onAttachedToEngine</span><span class="p">(</span><span class="nd">@NonNull</span> <span class="n">flutterPluginBinding</span><span class="p">:</span> <span class="nc">FlutterPlugin</span><span class="p">.</span><span class="nc">FlutterPluginBinding</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">val</span> <span class="py">taskQueue</span> <span class="p">=</span>
      <span class="n">flutterPluginBinding</span><span class="p">.</span><span class="n">binaryMessenger</span><span class="p">.</span><span class="nf">makeBackgroundTaskQueue</span><span class="p">()</span>
  <span class="n">channel</span> <span class="p">=</span> <span class="nc">MethodChannel</span><span class="p">(</span><span class="n">flutterPluginBinding</span><span class="p">.</span><span class="n">binaryMessenger</span><span class="p">,</span>
                          <span class="s">"com.example.foo"</span><span class="p">,</span>
                          <span class="nc">StandardMethodCodec</span><span class="p">.</span><span class="nc">INSTANCE</span><span class="p">,</span>
                          <span class="n">taskQueue</span><span class="p">)</span>
  <span class="n">channel</span><span class="p">.</span><span class="nf">setMethodCallHandler</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In Swift:</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  In release 2.10, the Task Queue API is only available on the <code class="language-plaintext highlighter-rouge">master</code> channel
  for iOS.</p>
</aside>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kd">func</span> <span class="nf">register</span><span class="p">(</span><span class="n">with</span> <span class="nv">registrar</span><span class="p">:</span> <span class="kt">FlutterPluginRegistrar</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">taskQueue</span> <span class="o">=</span> <span class="n">registrar</span><span class="o">.</span><span class="n">messenger</span><span class="o">.</span><span class="nf">makeBackgroundTaskQueue</span><span class="p">()</span>
  <span class="k">let</span> <span class="nv">channel</span> <span class="o">=</span> <span class="kt">FlutterMethodChannel</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.example.foo"</span><span class="p">,</span>
                                     <span class="nv">binaryMessenger</span><span class="p">:</span> <span class="n">registrar</span><span class="o">.</span><span class="nf">messenger</span><span class="p">(),</span>
                                     <span class="nv">codec</span><span class="p">:</span> <span class="kt">FlutterStandardMethodCodec</span><span class="o">.</span><span class="n">sharedInstance</span><span class="p">,</span>
                                     <span class="nv">taskQueue</span><span class="p">:</span> <span class="n">taskQueue</span><span class="p">)</span>
  <span class="k">let</span> <span class="nv">instance</span> <span class="o">=</span> <span class="kt">MyPlugin</span><span class="p">()</span>
  <span class="n">registrar</span><span class="o">.</span><span class="nf">addMethodCallDelegate</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="nv">channel</span><span class="p">:</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In Objective-C:</p>

<aside class="alert alert-info" role="alert">
  <p><i class="fas fa-info-circle"></i> <strong>Note:</strong>
  In release 2.10, the Task Queue API is only available on the <code class="language-plaintext highlighter-rouge">master</code> channel
  for iOS.</p>
</aside>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">registerWithRegistrar</span><span class="p">:(</span><span class="n">NSObject</span><span class="o">&lt;</span><span class="n">FlutterPluginRegistrar</span><span class="o">&gt;*</span><span class="p">)</span><span class="nv">registrar</span> <span class="p">{</span>
  <span class="n">NSObject</span><span class="o">&lt;</span><span class="n">FlutterTaskQueue</span><span class="o">&gt;*</span> <span class="n">taskQueue</span> <span class="o">=</span>
      <span class="p">[[</span><span class="n">registrar</span> <span class="nf">messenger</span><span class="p">]</span> <span class="nf">makeBackgroundTaskQueue</span><span class="p">];</span>
  <span class="n">FlutterMethodChannel</span><span class="o">*</span> <span class="n">channel</span> <span class="o">=</span>
      <span class="p">[</span><span class="n">FlutterMethodChannel</span> <span class="nf">methodChannelWithName</span><span class="p">:</span><span class="s">@"com.example.foo"</span>
                                  <span class="nl">binaryMessenger:</span><span class="p">[</span><span class="n">registrar</span> <span class="nf">messenger</span><span class="p">]</span>
                                            <span class="nl">codec:</span><span class="p">[</span><span class="n">FlutterStandardMethodCodec</span> <span class="nf">sharedInstance</span><span class="p">]</span>
                                        <span class="nl">taskQueue:</span><span class="n">taskQueue</span><span class="p">];</span>
  <span class="n">MyPlugin</span><span class="o">*</span> <span class="n">instance</span> <span class="o">=</span> <span class="p">[[</span><span class="n">MyPlugin</span> <span class="nf">alloc</span><span class="p">]</span> <span class="nf">init</span><span class="p">];</span>
  <span class="p">[</span><span class="n">registrar</span> <span class="nf">addMethodCallDelegate</span><span class="p">:</span><span class="n">instance</span> <span class="nf">channel</span><span class="p">:</span><span class="n">channel</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="jumping-to-the-ui-thread-in-android">
<a class="anchor" href="#jumping-to-the-ui-thread-in-android" aria-hidden="true"><span class="octicon octicon-link"></span></a>Jumping to the UI thread in Android</h3>

<p>To comply with channels’ UI thread requirement,
you might need to jump from a background thread
to Android’s UI thread to execute a channel method.
In Android, you can accomplish this by <code class="language-plaintext highlighter-rouge">post()</code>ing a
<code class="language-plaintext highlighter-rouge">Runnable</code> to Android’s UI thread <code class="language-plaintext highlighter-rouge">Looper</code>,
which causes the <code class="language-plaintext highlighter-rouge">Runnable</code> to execute on the
main thread at the next opportunity.</p>

<p>In Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">Handler</span><span class="o">(</span><span class="nc">Looper</span><span class="o">.</span><span class="na">getMainLooper</span><span class="o">()).</span><span class="na">post</span><span class="o">(</span><span class="k">new</span> <span class="nc">Runnable</span><span class="o">()</span> <span class="o">{</span>
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// Call the desired channel message here.</span>
  <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div>

<p>In Kotlin:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Handler</span><span class="p">(</span><span class="nc">Looper</span><span class="p">.</span><span class="nf">getMainLooper</span><span class="p">()).</span><span class="nf">post</span> <span class="p">{</span>
  <span class="c1">// Call the desired channel message here.</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="jumping-to-the-main-thread-in-ios">
<a class="anchor" href="#jumping-to-the-main-thread-in-ios" aria-hidden="true"><span class="octicon octicon-link"></span></a>Jumping to the main thread in iOS</h3>

<p>To comply with channel’s main thread requirement,
you might need to jump from a background thread to
iOS’s main thread to execute a channel method.
You can accomplish this in iOS by executing a
<a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html">block</a> on the main <a href="https://developer.apple.com/documentation/dispatch/dispatchqueue">dispatch queue</a>:</p>

<p>In Objective-C:</p>

<div class="language-objectivec highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dispatch_async</span><span class="p">(</span><span class="n">dispatch_get_main_queue</span><span class="p">(),</span> <span class="o">^</span><span class="p">{</span>
  <span class="c1">// Call the desired channel message here.</span>
<span class="p">});</span>
</code></pre></div></div>

<p>In Swift:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
  <span class="c1">// Call the desired channel message here.</span>
<span class="p">}</span>
</code></pre></div></div>



        
      </div>
    </main>
  </div>
</div>


    
      <footer class="site-footer">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12 site-footer__wrapper">
        <div class="site-footer__logo">
          <img src="/assets/images/shared/brand/flutter/logo/flutter-mono-81x100.png" alt="Flutter Logo" width="81" height="100">
        </div>
        <div class="site-footer__content">
          <ul class="site-footer__link-list">
              <li><a href="/tos">terms</a></li>
              <li><a href="/brand">brand usage</a></li>
              <li><a href="/security">security</a></li>
              <li><a href="https://www.google.com/intl/en/policies/privacy">privacy</a></li>
              <li><a href="https://esflutter.dev/">español</a></li>
              <li><a href="https://flutter.cn" class="text-nowrap">社区中文资源</a></li> 
              <li><a href="https://blog.google/inside-google/company-announcements/standing-with-black-community">We stand in solidarity with the Black community. Black Lives Matter.</a></li>
          </ul>
          <p class="licenses">
            Except as otherwise noted,
            this work is licensed under a
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0">Creative
            Commons Attribution 4.0 International License</a>,
            and code samples are licensed under the BSD License.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.1/umd/popper.min.js" integrity="sha512-ubuT8Z88WxezgSqf3RLuNi5lmjstiJcyezx34yIU2gAHonIi27Na7atqzUZCOoY4CExaoFumzOsFQ2Ch+I/HCw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/4.6.2/js/bootstrap.min.js" integrity="sha512-7rusk8kGPFynZWu26OKbTeI+QPoYchtxsmPeBqkHIEXJxeun4yJ4ISYe7C6sz9wdxeE1Gk3VxsIWgCZTc+vX3g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/3.0.1/js.cookie.min.js" integrity="sha512-wT7uPE7tOP6w4o28u1DN775jYjHQApdBnib5Pho4RB0Pgd9y7eSkAV1BTqQydupYDB9GBhTcQQzyNMPMV3cAew==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="/assets/js/vendor/code-prettify/prettify.js?v=1679552870"></script>
    <script src="/assets/js/vendor/code-prettify/lang-css.js?v=1679552870"></script>
    <script src="/assets/js/vendor/code-prettify/lang-dart.js?v=1679552870"></script>
    <script src="/assets/js/vendor/code-prettify/lang-yaml.js?v=1679552870"></script>
    <script src="/assets/js/tabs.js?v=1679552870"></script>
    <script src="/assets/js/archive.js?v=1679552870"></script>
    <script src="/assets/js/main.js?v=1679552870"></script>
    
    

  </body>
</html>
